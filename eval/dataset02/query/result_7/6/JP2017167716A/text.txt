<?xml version="1.0" encoding='utf-8'?>
<!-- <?xml-stylesheet type="text/xsl" href="../../../../../XSL/gat-a.xsl"?> -->
<!DOCTYPE jp-official-gazette PUBLIC "-//JPO//DTD PUBLISHED PATENT/UTILITY MODEL APPLICATION 1.0//EN" "../../../../../DTD/gat-a.dtd">
<jp-official-gazette kind-of-jp="A" kind-of-st16="A" lang="ja" dtd-version="1.0" country="JP" xmlns:jp="http://www.jpo.go.jp"><bibliographic-data lang="ja" country="JP">
    <publication-reference>
      <document-id>
        <country>JP</country>
        <doc-number>2017167716</doc-number>
        <kind>公開特許公報(A)</kind>
        <date>20170921</date>
      </document-id>
    </publication-reference>
    <application-reference>
      <document-id>
        <doc-number>2016050820</doc-number>
        <date>20160315</date>
      </document-id>
    </application-reference>
    <invention-title>プログラム及び情報処理装置</invention-title>
    <parties>
      <jp:applicants-agents-article>
        <jp:applicants-agents sequence="1">
          <applicant sequence="1">
            <addressbook lang="ja">
              <name>富士ゼロックス株式会社</name>
              <registered-number>000005496</registered-number>
              <address>
                <text>東京都港区赤坂九丁目７番３号</text>
              </address>
            </addressbook>
          </applicant>
          <agent sequence="1" jp:kind="representative">
            <addressbook>
              <name>特許業務法人ＹＫＩ国際特許事務所</name>
              <registered-number>110001210</registered-number>
            </addressbook>
          </agent>
        </jp:applicants-agents>
      </jp:applicants-agents-article>
      <inventors>
        <inventor sequence="1">
          <addressbook>
            <name>岸田  正吉</name>
            <address>
              <text>神奈川県横浜市西区みなとみらい六丁目１番  富士ゼロックス株式会社内</text>
            </address>
          </addressbook>
        </inventor>
      </inventors>
    </parties>
    <classification-ipc><edition/><main-clsf>G06F   3/12        20060101AFI20170825BHJP        </main-clsf><further-clsf>G06F  21/31        20130101ALI20170825BHJP        </further-clsf><further-clsf>G06F  21/62        20130101ALI20170825BHJP        </further-clsf></classification-ipc>
    <classification-national><country>JP</country><main-clsf>G06F3/12 339</main-clsf><further-clsf>G06F3/12 303</further-clsf><further-clsf>G06F3/12 338</further-clsf><further-clsf>G06F3/12 373</further-clsf><further-clsf>G06F21/31</further-clsf><further-clsf>G06F21/62</further-clsf></classification-national>
    <number-of-claims jp:adopted-law="claim">7</number-of-claims>
    <figure-to-publish>
      <fig-number>1</fig-number>
    </figure-to-publish>
    <jp:request-for-examination true-or-false="false"/>
    <jp:filing-form>ＯＬ</jp:filing-form>
    <jp:total-pages>21</jp:total-pages>
  </bibliographic-data><jp:image-of-bibliographic-data><img id="000001" he="140" wi="160" file="2017167716.tif" img-format="tif" img-content="drawing"/></jp:image-of-bibliographic-data><jp:image-of-chosen-drawing>
    <img id="000002" he="89" wi="69" file="2017167716.tif" img-format="tif" img-content="drawing"/>
  </jp:image-of-chosen-drawing><description>

<technical-field>
<p num="0001">
  本発明は、プログラム及び情報処理装置に関する。
</p>
</technical-field>
<background-art>
<p num="0002">
  特許文献１に記載されるシステムでは、ユーザの指示に応じて印刷装置に印刷を要求する端末装置に、印刷設定受付画面を表示する前に、上記印刷装置に印刷を行おうとしているユーザのＩＤ及びパスワードを送信して認証を要求させ、その認証結果と共に受信した権限情報を参照させて、上記印刷装置の機能のうち、利用を許可される機能に関する設定を受け付けるための印刷設定受付画面を表示させ、利用を許可される機能に関する設定を受け付けさせるようにしている。
</p>
<p num="0003">
  特許文献２に記載される複合機は、アプリケーションやファイル等の資源についてのユーザのアクセス権限とは別に、アプリケーションを構成するソフトウエア部品の組み合わせや動作条件を規定するマクロに対するアクセス権限を設定することができる。マクロに対するアクセス権限をユーザに与えることで、本来であれば利用権限の無い資源についても、マクロに定義された動作条件の範囲内で利用を許可している。
</p>
<p num="0004">
  特許文献３及び４には、複合機にあらかじめアカウントが登録されていないゲストユーザにその複合機の利用を許可するための仕組みが記載されている。この仕組みでは、複合機を利用したいゲストユーザは、複合機にアカウントを持つ正規ユーザのメールアドレスをＣｃ（カーボンコピー）アドレスとして含む暗証番号要求メールを複合機宛に送る。複合機は、そのメールに含まれるＣｃアドレスが、自機に登録された正規ユーザのアドレスであるか否かを判定し、正規ユーザのアドレスであれば、そのゲストユーザ用の一意な暗証番号を含んだ暗証番号通知メールを返信する。ゲストユーザは、暗証番号通知メールに示された暗証番号を複合機に入力することで、その複合機を利用することが可能になる。
</p>
</background-art>
<citation-list>
<patent-literature>
<p num="0005">
<patcit num="1"><text>特開２００７−２５７０３８号公報</text></patcit>
<patcit num="2"><text>特開２００９−０８７３１９号公報</text></patcit>
<patcit num="3"><text>特開２０１５−０２２６１７号公報</text></patcit>
<patcit num="4"><text>特開２０１５−０２２６１９号公報</text></patcit>
</p>
</patent-literature>
</citation-list>
<summary-of-invention>
<tech-problem>
<p num="0006">
  ところで、比較的規模の大きい企業その他の組織では、場所が異なる複数の拠点（例えば工場、ビル、ビル内のフロア）を有していることがしばしばである。そのような組織は、複合機等の機器群の状態を監視したり、各部門、各ユーザのそれら機器への利用権限を管理し、その利用の履歴を記録したりするために、機器管理システムを設けていることが多い。この機器管理システムは、通常、事業拠点ごとに設けられている場合が多く、組織全体の機器群を１つの機器管理システムで管理するケースはほとんど知られていない。機器の管理を全社レベルで統合するニーズ自体があまりなく、統合して管理するためのコストに見合った効果が得にくいことがその一因と考えられる。
</p>
<p num="0007">
  さて、ある拠点に設けられた機器管理システムに管理された機器群に対するゲストユーザは、組織に属しているか否かで２種類に分類できる。すなわち、その拠点を有する組織自体に所属していないユーザと、その組織に所属しているが（例えば別の拠点を居所としている等の理由で）その機器管理システムには登録されていないユーザである。前者は純粋な意味でのゲストであるのに対し、後者は機器管理システムから見ればゲストであるが、組織から見れば正規のユーザである。このように立場の異なる２種類のゲストユーザに対してそれぞれ異なる利用権限を付与できる仕組みが望まれる。
</p>
<p num="0008">
  本発明は、組織内の一システムに登録されていないユーザを単にゲストユーザとして一律にそのシステムの利用権限を与える場合と比べて、ゲストユーザと組織との関係を考慮したよりきめ細かい利用権限の付与ができるようにすることを目的とする。
</p>
</tech-problem>
<tech-solution>
<p num="0009">
  請求項１に係る発明は、コンピュータを、システムに登録された正規ユーザのための第１の利用許可手段であって、前記ユーザから前記システムに登録された認証情報が入力された場合に、前記システムに登録された前記正規ユーザの利用権限の範囲内で前記システムの利用を許可する第１の利用許可手段、前記システムに登録されていないゲストユーザのための第２の利用許可手段、として機能させるプログラムであって、前記第２の利用許可手段は、ゲストユーザから入力されたユーザ識別情報を取得する取得手段と、前記システムが設けられている組織のメンバの情報を保持するディレクトリサービスに対して、前記取得手段が取得した前記ユーザ識別情報が登録されているか否かを問い合わせる問合せ手段と、前記問合せ手段による問合せに対して登録されている旨の応答を受けた場合と登録されていない旨の応答を受けた場合とで異なる利用権限の範囲内で、前記ユーザ識別情報を入力した前記ゲストユーザに前記システムの利用を許可する許可手段と、を有することを特徴とするプログラムである。
</p>
<p num="0010">
  請求項２に係る発明は、前記ユーザ識別情報は前記ゲストユーザの通信アドレスであり、前記許可手段は、前記問合せ手段による問合せに対して登録されている旨の応答を受けた場合と登録されていない旨の応答を受けた場合とで異なる利用権限に対応付けた一時識別情報を前記通信アドレス宛に送信し、前記ゲストユーザから前記一時識別情報が入力された場合、前記一時識別情報に対応付けた前記利用権限に従って前記ゲストユーザに前記システムの利用を許可する、ことを特徴とする請求項１に記載のプログラムである。
</p>
<p num="0011">
  請求項３に係る発明は、前記第２の利用許可手段は、前記システムの利用要求を受けた場合に、その利用要求の送信元が前記情報処理装置と同じローカルネットワーク上の装置であれば、当該送信元の装置に対して第１の利用権限と対応付けた一時識別情報を提供する手段を更に有し、前記許可手段は、前記問合せ手段による問合せに対して登録されている旨の応答を受けた場合、前記第１の利用権限とは異なる第２の利用権限と対応付けた一時識別情報を前記ゲストユーザに提供し、前記ゲストユーザから前記一時識別情報が入力された場合、前記一時識別情報に対応付けた前記利用権限に従って前記ゲストユーザに前記システムの利用を許可する、ことを特徴とする請求項１に記載のプログラムである。
</p>
<p num="0012">
  請求項４に係る発明は、前記第２の利用許可手段は、前記ゲストユーザから利用対象に選択された前記システムの機能が、承認権限を有する正規ユーザの承認を必要とする機能であるか否かを判定する手段と、利用対象に選択された前記機能が承認を必要とすると判定された場合に、承認権限を有する正規ユーザに対して承認を求め、承認が得られると、前記ゲストユーザの利用権限に対して、利用対象に選択された前記機能が利用できる権限を追加する手段と、を更に有する請求項１〜３のいずれか１項に記載のプログラムである。
</p>
<p num="0013">
  請求項５に係る発明は、システムに登録された正規ユーザのための第１の利用許可手段であって、前記ユーザから前記システムに登録された認証情報が入力された場合に、前記システムに登録された前記正規ユーザの利用権限の範囲内で前記システムの利用を許可する第１の利用許可手段と、前記システムに登録されていないゲストユーザのための第２の利用許可手段と、を有し、前記第２の利用許可手段は、ゲストユーザから入力されたユーザ識別情報を取得する取得手段と、前記システムが設けられている組織のメンバの情報を保持するディレクトリサービスに対して、前記取得手段が取得した前記ユーザ識別情報が登録されているか否かを問い合わせる問合せ手段と、前記問合せ手段による問合せに対して登録されている旨の応答を受けた場合と登録されていない旨の応答を受けた場合とで異なる利用権限の範囲内で、前記ユーザ識別情報を入力した前記ゲストユーザに前記システムの利用を許可する許可手段と、を有する情報処理装置である。
</p>
<p num="0014">
  請求項６に係る発明は、コンピュータを、ユーザから利用対象に選択された機能が、承認権限を有する承認者ユーザの承認を必要とする機能であるか否かを判定する手段、利用対象に選択された前記機能が承認を必要とすると判定された場合に、前記承認者ユーザに対して承認を求め、承認が得られると、前記ユーザの利用権限に対して、利用対象に選択された前記機能が利用できる権限を追加する手段、として機能させるためのプログラムである。
</p>
<p num="0015">
  請求項７に係る発明は、ユーザから利用対象に選択された機能が、承認権限を有する承認者ユーザの承認を必要とする機能であるか否かを判定する手段と、利用対象に選択された前記機能が承認を必要とすると判定された場合に、前記承認者ユーザに対して承認を求め、承認が得られると、前記ユーザの利用権限に対して、利用対象に選択された前記機能が利用できる権限を追加する手段と、を有する情報処理装置である。
</p>
</tech-solution>
<advantageous-effects>
<p num="0016">
  請求項１又は５に係る発明によれば、組織内の一システムに登録されていないユーザを単にゲストユーザとして一律にそのシステムの利用権限を与える場合と比べて、ゲストユーザと組織との関係を考慮したよりきめ細かい利用権限の付与ができる。
</p>
<p num="0017">
  請求項２に係る発明によれば、組織のメンバでない人が組織のメンバの通信アドレスを入力したとしても、その人には組織のメンバの利用権限が与えられないようにすることができる。
</p>
<p num="0018">
  請求項３に係る発明によれば、ローカルネットワークへの参加が認められているゲストユーザに一定の利用権限を与えつつ、更に組織のメンバについてはメンバとしての利用権限を与えることができる。
</p>
<p num="0019">
  請求項４に係る発明によれば、承認権限を持つ正規ユーザの利用権限全部をユーザに付与する方式と比べて、より高いセキュリティを実現できる。
</p>
<p num="0020">
  請求項６又は７に係る発明によれば、承認する承認者ユーザの利用権限全部をユーザに付与する方式と比べて、より高いセキュリティを実現できる。
</p>
</advantageous-effects>
</summary-of-invention>
<description-of-drawings>
<p num="0021">
<figref num="1">第１実施形態の方式が適用されるシステムの構成を示す図である。</figref>
<figref num="2">第１実施形態の機器管理システムの構成例を示す図である。</figref>
<figref num="3">ユーザ情報ＤＢに登録された正規ユーザの情報の例を示す図である。</figref>
<figref num="4">一時利用管理部が管理する操作ＩＤ情報の例を示す図である。</figref>
<figref num="5">社内ゲスト用の利用権限と社外ゲスト用の利用権限の例を示す図である。</figref>
<figref num="6">第１実施形態におけるゲストによる機器利用の流れを説明するための図である。</figref>
<figref num="7">第１実施形態において、ゲストが承認不要の機能を利用する際の処理を示すシーケンス図である。</figref>
<figref num="8">第１実施形態において、ゲストが承認の必要な機能を利用する際の処理を示すシーケンス図である。</figref>
<figref num="9">第２実施形態の方式が適用されるシステムの構成を示す図である。</figref>
<figref num="10">第２実施形態の機器管理システムの構成例を示す図である。</figref>
<figref num="11">第２実施形態において、ゲストが承認不要の機能を利用する際の処理を示すシーケンス図である。</figref>
<figref num="12">第２実施形態においてゲストの携帯端末に提供される操作ＩＤ通知用のウェブページの表示例を示す図である。</figref>
</p>
</description-of-drawings>
<description-of-embodiments>
<p num="0022">
＜第１実施形態＞<br/>
  図１は、本発明の一実施形態の方式が適用されるシステム構成の例を示す。
</p>
<p num="0023">
  図１に例示するシステムは、例えば、企業や学校等の組織に設置された機器２０の利用管理のためのシステムである。管理の対象である機器２０は、ユーザに対して何らかのサービスを提供する装置であり、例えばプリンタ、スキャナ、複写機、ファクシミリ装置、複合機（プリンタ、スキャナ、複写機、ファクシミリ装置等の機能を併せ持つ装置）等がその例である。
</p>
<p num="0024">
  図１に示すように、組織は複数の拠点Ａ、Ｂ、Ｃ、・・・を有している。拠点Ａ、Ｂ、Ｃ、・・・の各々には、ＬＡＮ（ローカルエリアネットワーク）等のローカルネットワーク３０が設けられている。ローカルネットワーク３０には、パーソナルコンピュータ、各種サーバ、機器２０、及び機器管理システム１０が接続されている。
</p>
<p num="0025">
  拠点に設けられた機器管理システム１０は、その拠点のローカルネットワーク３０に接続された機器２０の管理を行う情報処理システムである。機器管理システム１０が実行する処理には、例えば、各機器２０を利用しようとするユーザのユーザ認証、それら各機器２０に対するユーザの利用の制御がある。また機器管理システム１０は、それら各機器の利用履歴を記録する機能を有していてもよい。
</p>
<p num="0026">
  拠点の機器管理システム１０には、その拠点を主たる居所にしている者等のように、（組織内の複数の拠点のうち）その拠点を主に利用しているユーザが登録されており、組織内の別の拠点を主に利用しているユーザは登録されていない。機器管理システム１０に登録されているユーザは、登録したユーザＩＤ（識別情報）及びパスワードを機器２０に入力したり、ユーザＩＤ等を保持したＩＣカードを機器２０付属の読み取り機に読み取らせたりすることで、機器管理システム１０の認証を受ける。そして、この認証に合格すると、機器管理システム１０に登録されたそのユーザの利用権限の範囲内で、その機器２０の利用が可能になる。逆に、組織に属している者でも、拠点の機器管理システム１０にユーザ登録されていない者は、その拠点内の機器を利用するには、利用権限の付与を受ける必要がある。
</p>
<p num="0027">
  組織には、その組織に所属する全メンバの属性情報が登録されたディレクトリサービス５０が設けられている。ディレクトリサービス５０に登録されるメンバの属性情報には、例えば、そのメンバの氏名、ユーザＩＤ（例えば社員番号）、パスワード、電子メールアドレス、所属部署等がある。ディレクトリサービス５０は、組織内の他の情報処理装置（例えば機器管理システム１０）からの問合せに応じて、登録された各メンバの情報を検索し、その検索結果を問合せ元の情報処理装置に応答する。ディレクトリサービス５０は、例えばＬＤＡＰ（Lightweight Directory Access Protocol）に準拠したサーバとして構築されている。
</p>
<p num="0028">
  ディレクトリサービス５０は、組織全体を対象として構築されており、組織の全メンバの情報を保持し、組織内のすべての拠点の情報処理装置からの問合せに応答する。これに対して機器管理システム１０は、あくまでその機器管理システム１０が設けられている拠点を対象としており、他の拠点の機器２０は管理しないし、組織のメンバであっても他の拠点を主に利用するユーザについては認証情報や利用権限を個別に管理しない。機器管理システム１０にとっては、組織のメンバであっても当該システム１０にユーザ登録されていない者は、組織のメンバでない人と同様、「ゲスト」である。ただし、機器管理システム１０は、ディレクトリサービス５０を利用することで、ゲストを組織のメンバと組織に属さない人とに分類し、各々の分類に応じた利用権限を与える。
</p>
<p num="0029">
  ディレクトリサービス５０と各拠点の機器管理システム１０とは、例えばＶＰＮ（仮想プライベートネットワーク）を介して接続されている。
</p>
<p num="0030">
  図２に、機器管理システム１０の内部構成の例を示す。図２に例示する機器管理システム１０は、ユーザ情報ＤＢ（データベース）１０２、ログイン処理部１０４、権限管理部１０６、利用履歴記録部１０８、一時利用管理部１１０を有する。
</p>
<p num="0031">
  ユーザ情報ＤＢ１０２は、当該機器管理システム１０に登録されている各ユーザのユーザ情報を記憶するデータベースである。ユーザ情報ＤＢ１０２には、例えば、図３に例示するように、ユーザＩＤ、電子メールアドレス、パスワード等の認証情報、承認権限、機器２０に対する利用権限、等を記憶している。図３に例示した利用権限は、機器２０が複合機である場合の例であり、コピー、プリント、スキャン、ファクシミリという４つの機能のそれぞれについてのユーザの権限を示している。例えば、ユーザ「ABC1234」は、コピー及びプリントについては、白黒の両面出力のみが許可され、スキャンとファックス送信は許可されていない。図ではプリント等の４つの機能の利用権限を示したが、ユーザ情報ＤＢ１０２には更に別の機能についての利用権限の情報が登録されていてもよい。承認権限は、当該ユーザ（例えばユーザ「BCD2345」）が他のユーザに対して機器２０の利用を承認する権限である。承認権限があるユーザは、当該ユーザが持つ利用権限の範囲内で、他のユーザに機器２０の利用を許可できる。ユーザ「ABC1234」は、承認権限がないので、他者の機器２０の利用を承認することはできないが、仮に承認権限があったとしても、その場合に承認できるのは、白黒・両面でのコピー及びプリントだけであり、白黒・片面やカラーでのコピー・プリントは承認することができず、スキャンやファクシミリ送信も承認できない。
</p>
<p num="0032">
  ログイン処理部１０４は、機器２０を利用しようとするユーザのログイン処理を行う。例えば、機器管理システム１０に登録されているユーザが、機器２０の表示装置（例えばタッチパネル）に表示されたログイン画面に対してユーザＩＤ及びパスワードを入力すると、そのユーザＩＤ及びパスワードが機器管理システム１０に送られる。すると、ログイン処理部１０４が、そのユーザＩＤ及びパスワードがユーザ情報ＤＢ１０２に登録されているかどうかを調べ、登録されていれば、そのユーザのログインを認め、ユーザにその機器２０の利用を許可する。また１つの実施例では、ログイン処理部１０４は、ユーザがログイン画面に入力した情報が登録済みのユーザＩＤ及びパスワードではなく、電子メールアドレスのみである場合に、そのログイン要求を一時利用の要求であると認識して、一時利用管理部１１０にその要求の処理を依頼する。また、ユーザＩＤ等を手入力する形のログインの他に、ユーザがＮＦＣ（Near Field Communication）等の近接無線規格に準拠したＩＣ内蔵ＩＤカード（例えば社員証カード）を機器２０の無線通信ポートに近接させることでログインを行う場合もある。この場合、ログイン処理部１０４は、機器２０から送られてくるそのＩＤカードの読み取り結果の認証情報が、ユーザ情報ＤＢ１０２に登録されていれば、そのユーザのログインを認める。またその認証情報がユーザ情報ＤＢ１０２に登録されていない場合、ログイン処理部１０４は、そのログイン要求を一時利用の要求であると認識して、一時利用管理部１１０にその要求の処理を依頼してもよい。
</p>
<p num="0033">
  権限管理部１０６は、機器２０にログインしているユーザに対して、ユーザ情報ＤＢ１０２に登録されている利用権限の範囲内で、その機器２０の利用を許可する。すなわち、権限管理部１０６は、ユーザが実行を指示した機能についての権限問合せを機器２０から受け取ると、そのユーザがその機能を使用する権限を持っているかをユーザ情報ＤＢ１０２内の当該ユーザの権限情報に照らして判定する。そして、権限情報から権限ありと判定した場合には利用許可の旨を、権限なしと判定した場合には利用拒否の旨を機器２０に応答する。例えば、ユーザ情報ＤＢ１０２に登録されているユーザの利用権限において、機器２０の複写機能に関して白黒出力は許可されているがカラー出力は許可されていない場合、権限管理部１０６は、ユーザからの白黒コピーの要求は許可するが、カラーコピーの要求は拒否する。
</p>
<p num="0034">
  利用履歴記録部１０８は、各機器２０の利用履歴（ログ）情報を記録する。
</p>
<p num="0035">
  一時利用管理部１１０は、機器管理システム１０に登録されていないユーザ（すなわちゲストユーザ）による機器２０の一時的な利用を管理する。一時利用管理部１１０は、ディレクトリサービス５０に対して問合せを行うことで、一時利用を要求したゲストユーザ（以下ゲストと呼ぶ）が、当該組織に所属しているユーザ（例えば組織が会社の場合、社員）であるか否かを判別する。そして、当該組織に所属しているゲストには、そうでないゲストとは異なる利用権限を付与する。この問合せを行うのが問合せ部１１２である。問合せ部１１２は、ＬＤＡＰ等、ディレクトリサービス５０が対応しているプロトコルを用いて問合せを行う。１つの例では、ゲストは、ログインの際自分の電子メールアドレスを入力し、問合せ部１１２は、その電子メールアドレスが登録されているか（すなわち組織のいずれかのメンバのものであるか）をディレクトリサービス５０に問い合わせる。
</p>
<p num="0036">
  操作ＩＤ発行部１１４は、ゲストに対して、一時利用のための識別情報である操作ＩＤを発行する。操作ＩＤは、ゲストの種別に応じた利用権限に対応付けられる。また、ゲストが、機器管理システム１０に登録されたユーザ（以下「正規ユーザ」と呼ぶ）から承認を受けた場合、操作ＩＤには承認を受けた権限の情報も対応付けられる。
</p>
<p num="0037">
  操作ＩＤ管理部１１６は、各操作ＩＤの情報を管理し、ユーザが機器２０に対して指示した操作が、そのユーザの提示した操作ＩＤに対応する利用権限で利用可能かどうかを判断し、その判断の結果に従ってその操作を許可又は拒否する。
</p>
<p num="0038">
  図４に、操作ＩＤ管理部１１６が管理する操作ＩＤの情報の例を示す。この情報には、操作ＩＤ、関連アドレス、ＩＤタイプ、承認者、利用権限、有効期限の各項目が含まれる。
</p>
<p num="0039">
  関連アドレスは、ログインの際にゲストが入力した電子メールアドレスである。
</p>
<p num="0040">
  ＩＤタイプは、その操作ＩＤの種別であり、例えば社内ゲスト、社外ゲスト、承認済み等の値をとる。ＩＤタイプ「社内ゲスト」は、当該組織のメンバである（すなわちディレクトリサービス５０に登録されている）がその機器管理システム１０には登録されていないユーザ（以下この条件に該当するユーザを「社内ゲスト」と呼ぶ）と判定されたユーザに対して発行される操作ＩＤのタイプである。ＩＤタイプ「社外ゲスト」は、当該組織に属していない（すなわちディレクトリサービス５０に登録されていない）ゲスト（以下この条件に該当するユーザを「社外ゲスト」と呼ぶ）と判定されたユーザに対して発行される操作ＩＤのタイプである。ＩＤタイプ「承認済み」は、承認権限のある正規ユーザから承認を得た権限を含む利用権限に対応付けられた操作ＩＤのタイプである。操作ＩＤの付与を受けた社内ゲスト又は社外ゲストが、その操作ＩＤに対応する利用権限では利用できない機能を利用するために、承認権限のある正規ユーザから承認を得た場合、その承認を得た権限に対応する操作ＩＤのタイプは「承認済み」となる。
</p>
<p num="0041">
  承認者は、「承認済み」タイプの操作ＩＤに関して、承認を行った正規ユーザの識別情報である。この例では、正規ユーザの識別情報として、その正規ユーザの電子メールアドレスを用いている。
</p>
<p num="0042">
  利用権限は、その操作ＩＤに対応付けられた機器２０の利用権限である。例えば、ディレクトリサービス５０への問合せの結果、社内ゲストと判定されたユーザに対して付与される操作ＩＤには、社内ゲスト用にあらかじめ定められている利用権限が対応付けられる。また社外ゲストと判定されたユーザに付与される操作ＩＤには、社外ゲスト用にあらかじめ定められている利用権限が対応付けられる。
</p>
<p num="0043">
  例えば、一時利用管理部１１０は、図５に例示する社内ゲスト用の利用権限情報２０２と社外ゲスト用の利用権限情報２０４を有しており、社内ゲストに発行した操作ＩＤには前者を、社外ゲストに発行した操作ＩＤには後者を、それぞれ対応付ける。なお、図５の例では、社内ゲストには、社内ルールに従って、白黒・両面のコピー・プリントのみしか許可されないのに対し、組織にとっての来客である社外ゲストにはカラーでのコピー・プリントが許可される。またスキャンとファクシミリ送信については、社内ゲストも社外ゲストも許可されない。なお、図５に示した社内ゲスト用及び社外ゲスト用の利用権限はあくまで一例に過ぎない。これら利用権限の内容は機器管理システム１０の管理者等が、組織や拠点のセキュリティポリシーに従って定めればよい。
</p>
<p num="0044">
  また、「承認済み」の操作ＩＤには、承認された権限を含む利用権限が対応付けられる。図４の例では、社内ゲストであるユーザ「guest1@fuji.local」には、ログイン時には、社内ゲスト用の利用権限情報２０２に対応付けられた操作ＩＤ「2345」が付与されている。その後そのユーザが正規ユーザ「auth@fuji.local」から承認を受けると、例えばその正規ユーザから承認された機能を利用できる権限が追加された新たな操作ＩＤ「3456」がその社内ゲストに付与される。例えば、コピー・プリントが白黒・両面強制で、スキャンとファクシミリ送信が許可されない利用権限を持つゲストが、承認者からスキャンの権限の承認を得た場合、コピー・プリントが白黒・両面強制、スキャンは許可、ファクシミリ送信は不許可の新たな利用権限が生成され、この利用権限に対応付けられた新たな操作ＩＤがそのゲストに提供される。またこのように利用権限の更新に伴って新たな操作ＩＤを発行するという方式もあくまで一例に過ぎない。この代わりに、操作ＩＤ情報（図４）において、ゲストに付与した操作ＩＤに対応づける利用権限の情報を、承認等に伴って更新していってもよい。
</p>
<p num="0045">
  有効期限は、操作ＩＤの有効期限の日時を示す。有効期限をどのように定めるかは、機器管理システム１０の運用者が決めればよい。あくまで一例であるが、操作ＩＤを発行した日の業務時間の終了時刻を有効期限として設定する等でよい。
</p>
<p num="0046">
  図６を参照して、本実施形態の処理の流れを、ユーザインタフェースの観点から説明する。
</p>
<p num="0047">
  （１）機器２０付属の表示装置（タッチパネル）に表示されるログイン画面３００には、電子メールアドレス又はユーザＩＤを入力するＩＤ欄３０２と、パスワード欄３０４と、ログインボタン３０６が表示される。機器管理システム１０に登録されている正規ユーザは、登録されているユーザＩＤ及びパスワードをＩＤ欄３０２及びパスワード欄３０４に入力し、ログインボタン３０６を押下する。また図示は省略したがログイン画面３００には、「ご来訪の方はメールアドレス／ＩＤの欄に電子メールアドレスを入力し、ログインボタンを押してください。パスワードは不要です。社内他部署の方は社員としての電子メールアドレスを入力してください。」等の案内が表示される。ゲストは、ＩＤ欄３０２に自分の電子メールアドレスを入力し、ログインボタン３０６を押下する。これにより、ログイン処理が行われる。以下では、ゲストがログインした場合の流れを説明する。
</p>
<p num="0048">
  （２）ログインの後、表示装置には、メニュー画面３１０が表示される。メニュー画面３１０には、コピー、スキャナ（スキャン結果を指定のメールアドレスに送信）、共有フォルダを開く等、機器２０が提供する各種機能を表すアイコンが表示される。ゲストは、使用したい機能のアイコンにタッチする。
</p>
<p num="0049">
  （３）この時点では、そのゲストは、操作ＩＤの入力による権限の証明をまだ行っていないので、機器２０及び機器管理システム１０に対して利用権限がない。この場合、機器２０の表示装置には、操作ＩＤ入力画面３２０が表示される。ゲストが既に操作ＩＤを取得している場合には、その画面内の操作ＩＤ入力欄３２２にその操作ＩＤを入力し、操作継続ボタン３２４を押下する。その操作ＩＤに対応する利用権限が、上記（２）でタッチした機能の利用が可能なものであれば、機器２０はその機能を実行する。そうでなければ、その操作ＩＤではその機能が利用できない旨のメッセージと共に、再度操作ＩＤ入力画面３２０が表示される。ゲストは、操作ＩＤを入手していない場合、操作ＩＤ入力画面３２０内のＩＤ取得要求ボタン３２６を押す。すると、その要求が機器２０から機器管理システム１０に伝達され、機器管理システム１０は、そのゲストの種別（社内ゲスト／社外ゲスト）に応じた利用権限に対応付けた操作ＩＤを生成し、その操作ＩＤを含んだ電子メールをそのゲストの電子メールアドレス宛に送る。ゲストは、携帯している端末でその電子メールを受信し、その電子メールに示される操作ＩＤを、操作ＩＤ入力欄３２２に入力し、操作継続ボタン３２４を押下することで、選んだ機能を実行することができる。なお、ゲストの種別によっては、上記（２）で選んだ機能の利用が許可されない場合がある。この場合、入手した操作ＩＤを操作ＩＤ入力画面３２０に入力しても、その機能は利用できない（この場合画面にエラー表示がなされる）。
</p>
<p num="0050">
  （４）メニュー画面３１０に表示される機能の中には、ゲストの場合、承認権限を持つ正規ユーザにより承認を受けないと利用できないものがある（なお、正規ユーザの場合、自分の利用権限の範囲内であれば、その機能を承認不要で利用できる）。上記（２）でゲストが選んだ機能がそのような機能である場合、機器２０の表示装置には、承認申請画面３３０が表示される。この画面には、操作ＩＤ入力欄３３２と承認者メールアドレス入力欄３３４が含まれる。当該機能についてまだ承認を受けていないゲストの場合、承認者メールアドレス入力欄３３４に承認者のメールアドレスを入力し、ＩＤ取得要求ボタン３３８を押下する。ゲストには、通常、拠点内に訪問先の正規ユーザがいることが想定される。特にセキュリティに厳しい企業の場合には、そのようなことが一般的である。したがって、承認者メールアドレス入力欄３３４には、訪問先のいずれかの正規ユーザのメールアドレスを聞いて入力すればよい。承認者のメールアドレスを入力してＩＤ取得要求ボタン３３８を押下すると、機器管理システム１０がそのメールアドレスに対して承認依頼の電子メールを送る。このメールを受け取った承認者が承認操作を行うと、機器管理システム１０は、当該機能が利用できる権限が追加された新たな利用権限に対応付けられた新たな操作ＩＤを生成し、その新たな操作ＩＤを表示した電子メールをそのゲストのメールアドレスに送る。ゲストは、携帯している端末でその電子メールを受信し、その電子メールに示される操作ＩＤを、承認申請画面３３０内の操作ＩＤ入力欄３３２に入力し、操作継続ボタン３３６を押下することで、選んだ機能を実行することができる。
</p>
<p num="0051">
  次に、図７及び図８に示すシーケンス図を参照して、本実施形態の処理の流れを更に詳しく説明する。
</p>
<p num="0052">
  図７は、メニュー画面３１０上でゲストが選択した機能が、承認者の承認を必要としない機能である場合の流れを示す。
</p>
<p num="0053">
  まずユーザが、機器２０のコンソールに表示されたログイン画面３００に対して自分のユーザＩＤ又は電子メールアドレスと、パスワード（正規ユーザの場合）と、を入力し、ログインボタンを押下する（Ｓ１）。これを受けて、機器２０は、ログイン処理を開始する（Ｓ２）。すなわち、機器２０は、ユーザが入力した情報を機器管理システム１０に送信し、ログイン処理を依頼する。
</p>
<p num="0054">
  この依頼を受けた機器管理システム１０は、ユーザが入力した情報が、ユーザＩＤ又は電子メールアドレスと、パスワード（正規ユーザの場合）との２つを含んでいる場合、それら２つの組み合わせに合致するユーザがユーザ情報ＤＢ内に存在するかどうかを判定する（Ｓ３）。存在する場合は、そのユーザは機器管理システム１０にとって正規ユーザである。この場合、機器管理システム１０は、ユーザ情報ＤＢ１０２に登録されたそのユーザの利用権限の情報に従い、従来と同様の制御で、そのユーザからの操作指示を許可又は拒否すればよい。入力されたユーザＩＤ等とパスワードとの組み合わせに合致するユーザが見つからない場合は、ユーザに再入力を促すなどのエラー処理を実行する。なお、正規ユーザの場合の処理は従来同様でよいので、図７では、Ｓ４以降はユーザがゲストである場合の流れを示している。
</p>
<p num="0055">
  Ｓ１でユーザが入力した情報が電子メールアドレスのみである場合、機器管理システム１０（問合せ部１１２）は、その電子メールアドレスを含む問合せをディレクトリサービス５０に送る。ディレクトリサービス５０は、登録されている組織内の各メンバの情報の中に、その問合せに係る電子メールアドレスを含んだものがあるかどうかを調べ、その有無の結果を機器管理システム１０に返す。機器管理システム１０（一時利用管理部１１０）は、問合せに対する応答が「（ディレクトリサービス５０に登録が）有り」であれば、今回ログインしたユーザは社内ゲストであると判断し、「無し」であれば「社外ゲスト」であると判定する（Ｓ４）。一時利用管理部１１０は、機器２０を減殺使用中のユーザの情報として、Ｓ１で入力された電子メールアドレスと、Ｓ４で判定したゲスト種別（社内／社外）の情報とを記憶する。
</p>
<p num="0056">
  Ｓ２の後、機器２０は、メニュー画面３１０を表示する（Ｓ５）。図７の例では、ユーザ（ゲスト）は、メニュー画面３１０上で、承認処理の対象でない機能「コピー」のアイコンを選択したとする。機器２０は、ユーザが選択した機能「コピー」について利用権限を持つかどうかを機器管理システム１０に問い合わせる（Ｓ６）。
</p>
<p num="0057">
  図７の例では、そのゲストは、Ｓ６の時点までに一度も操作ＩＤを入力していないので、いずれの機能についても利用権限を持っていない。したがって、機器管理システム１０は、操作ＩＤの入力が必要と判断する（Ｓ７）。機器管理システム１０は、機器２０に対して操作ＩＤ入力画面３２０（図６参照）の表示を指示する（Ｓ８）。
</p>
<p num="0058">
  ゲストは、まだ操作ＩＤを入手していないので、操作ＩＤ入力画面３２０のＩＤ取得要求ボタン３２６を押す（Ｓ９）。その要求は機器２０から機器管理システム１０に伝達される。機器管理システム１０は、その要求に応じて、操作ＩＤを生成する（Ｓ１０）。機器管理システム１０は、Ｓ１、Ｓ２でログインしたユーザのゲスト種別の情報を記憶している（Ｓ４参照）ので、Ｓ１０では、生成した操作ＩＤを、そのゲスト種別に応じた利用権限（図５参照）、電子メールアドレス等の情報と対応付けて、操作ＩＤ情報（図４）に登録する。またこのときその操作ＩＤの有効期限を決定し、その有効期限を操作ＩＤ情報に登録する。機器管理システム１０は、生成した操作ＩＤを示す電子メールを、その電子メールアドレス宛に送信する（Ｓ１１）。
</p>
<p num="0059">
  機器管理システム１０は、機器２０に再び操作ＩＤ入力画面３２０を表示させる（Ｓ１２）。ゲストは、機器管理システム１０からの電子メールを自分の携帯端末で閲覧し、そこに示される操作ＩＤを操作ＩＤ入力画面３２０に入力する（Ｓ１３）。機器管理システム１０は、入力された操作ＩＤに対応する利用権限の情報を操作ＩＤ情報から求め、ゲストが現在要求中の機能「コピー」がその利用権限の範囲内か否かを判断し、範囲内であれば、コピー処理を実行する（Ｓ１４）。例えば、そのゲストが、コピーに関しては白黒・両面出力が強制される権限内容の社内ゲスト（図５参照）であった場合、Ｓ１３での操作ＩＤの入力により、機器２０はコピーの設定画面を表示するが、その設定画面ではカラー設定は「白黒」に、片面／両面設定は「両面」に固定され、変更できない。ゲストは、他の変更可能な設定項目を必要に応じて変更し、コピーを実行する。現在要求中の機能「コピー」がその利用権限の範囲外（コピー自体が不許可）であれば、そのゲストの権限ではその機能は利用できない旨のメッセージを含むエラー画面を機器２０に表示させる。
</p>
<p num="0060">
  ゲストが要求した機能に対応する処理が機器２０で実行された場合、機器管理システム１０は、その処理のログ（履歴情報）を利用履歴記録部１０８に記録する。そのログには、その処理を要求したユーザを示す情報として、Ｓ１で入力された電子メールアドレスが記録される。
</p>
<p num="0061">
  図８を参照して、メニュー画面３１０上でゲストが選択した機能が、承認者の承認を必要とする機能である場合の流れを例示する。この流れのうち、電子メールアドレスの入力（Ｓ１）〜ゲスト種別の判断（Ｓ４）及びメニュー画面３１０の表示（Ｓ５）までの流れは図７の例と同じなので、図８ではＳ１〜Ｓ５のステップは図示を省略している。
</p>
<p num="0062">
  Ｓ５で表示されたメニュー画面３１０に対し、ゲストが選択した機能が、承認を要するスキャン機能であったとする（Ｓ６Ａ）。そのゲストは、Ｓ６Ａの時点までに一度も操作ＩＤを入力していないので、機器管理システム１０は、操作ＩＤの入力が必要であると判断すると共に、要求されたスキャン機能は承認が必要であると判断する（Ｓ７Ａ）。機器管理システム１０は、各機能が承認が必要であるか不要であるかを示す情報を保持しており、Ｓ７Ａではこの情報に基づいて判断を行う。この判断に従い、機器管理システム１０は、機器２０に対して承認申請画面３３０（図６参照）の表示を指示する（Ｓ８Ａ）。ゲストは、まだ承認を得ていないので、承認申請画面３３０の承認者メールアドレス入力欄３３４に、例えば訪問先の正規ユーザのうち承認権限を持つ者の電子メールアドレスを入力し、ＩＤ取得要求ボタン３３８を押す（Ｓ９Ａ）。その要求は機器２０から機器管理システム１０に伝達される。
</p>
<p num="0063">
  機器管理システム１０は、入力された承認者のメールアドレスに該当するユーザをユーザ情報ＤＢ１０２（図３参照）から検索し、検索したユーザが承認権限を持っているか確認する（Ｓ２１）。該当するユーザが見つからない場合や、見つかっても承認権限がない場合は、別の承認者の入力を促すエラー画面を機器２０に表示させる。また、ユーザが入力した承認者が承認権限を持っていても、Ｓ６Ａでユーザが選択した機能に対して利用権限を持っていなければ、同様のエラー画面を機器２０に表示させる。
</p>
<p num="0064">
  Ｓ２１で、入力された承認者が適切であると判断した場合、機器管理システム１０は、その承認者の電子メールアドレス宛に、承認依頼の電子メールを送る（Ｓ２２）。この電子メールには、例えば「＜Ｓ１で入力されたゲストの電子メールアドレス＞から複合機のスキャン機能の利用権限の承認を求められています。下記ＵＲＬにアクセスして承認処理を行ってください。」等のメッセージと、承認処理のためのＵＲＬ（Uniform Resource Locator）とが含まれる。このＵＲＬは、その承認依頼に対する承認のために機器管理システム１０が生成した承認用ウェブページのＵＲＬである。承認者が自分の端末からそのＵＲＬにアクセスすると、ログインページが提供され、そのログインページに対してユーザＩＤ及びパスワードを入力すると、その承認用ウェブページが提供される。承認者がそのページに示される承認ボタンを押下する（Ｓ２３）と、機器管理システム１０は、操作ＩＤを生成し、その操作ＩＤを、ゲストから要求され承認されたスキャンの権限を含んだ利用権限に対応付けて操作ＩＤ情報（図４）に登録する（Ｓ２４）。このとき操作ＩＤに対応付ける利用権限は、そのゲストの種別に応じた利用権限に対してスキャンの権限を追加したものである。機器管理システム１０は、生成した操作ＩＤを示す電子メールを、その電子メールアドレス宛に送信する（Ｓ１１）。Ｓ１１以降の処理は、図７の例と同様である。
</p>
<p num="0065">
  以上に説明したように、本実施形態では、機器管理システム１０は、ディレクトリサービス５０を参照してゲストの種別が社内（当該組織に属する）、社外（属さない）のいずれであるかを判別し、判別した種別に応じた利用権限をそのゲストに付与する。また、本実施形態では、ゲストは、特定の機能については、権限のある承認者に承認を受けて初めて利用できるようになる。
</p>
<p num="0066">
  図７の例では、ログインしたゲストの種別が判明（Ｓ４）した時点ではまだ操作ＩＤをゲストに提供せず、そのゲストがメニュー画面３１０で利用したい機能を指示（Ｓ６）した後に、ゲストに操作ＩＤを提供した（Ｓ８〜Ｓ１１）。しかしこのような流れはあくまで一例に過ぎない。例えば、Ｓ４でゲスト種別がした時点で、機器管理システム１０がその種別に応じた利用権限に対応付けた操作ＩＤを生成し、そのゲストの電子メールアドレス宛に送信してもよい。このようにした場合、Ｓ８で機器２０に表示された操作ＩＤ入力画面３２０に対し、ゲストはＳ４の時点で受け取った操作ＩＤを入力することができる。
</p>
<p num="0067">
  以上の例では、ゲストユーザに電子メールアドレスを入力させ、その電子メールアドレスに対して操作ＩＤ通知用の電子メールを送信したが、このような電子メールの利用は一例に過ぎない。ゲストユーザに電子メールアドレス以外の他の通信アドレスを入力させてもよい。例えば電子メールの代わりに携帯電話番号をゲストユーザに入力させ、ショートメッセージサービス等、携帯電話番号を通信アドレスとして利用する他の通知手段を用いて操作ＩＤをゲストユーザに通知するようにしてもよい。
</p>
<p num="0068">
＜第２実施形態＞<br/>
  図９にこの実施形態の方式が適用されるシステム構成の例を示す。図９において図１に示した要素と同様の要素には同一符号を付して説明を省略する。
</p>
<p num="0069">
  この実施形態では、拠点内のローカルネットワーク３０には無線ＡＰ（アクセスポイント）４０が設けられている。ゲストは、スマートフォン等の携帯端末６０から、Wi-Fi（商標）等の無線ＬＡＮ規格に準拠した無線通信により無線ＡＰ４０に接続し、ローカルネットワーク３０に参加する。携帯端末６０から無線ＡＰ４０に無線接続するには、無線ＡＰ４０のＳＳＩＤ（Service Set Identifier）と暗号化キー（パスワード）の情報が必要であるが、ゲストはこれらの情報を、拠点内の訪問先の正規ユーザから知らされているものとする。逆に言えば、ここでのゲストは、無線ＡＰ４０のＳＳＩＤ及び暗号化キーを教えてもらえるほど拠点や組織から信頼されている者であり、例えば同組織内の他拠点のメンバや、組織と協業している組織外の協業者等がその例である。
</p>
<p num="0070">
  機器管理システム１０は、機器２０の利用のための操作ＩＤの発行要求を受け付けるためのＵＲＬを用意しており、ゲストがそのＵＲＬにアクセスすると、ＩＤ発行受付用のウェブページを提供する。ただし、このアクセスは、機器管理システム１０と同じローカルネットワーク３０（サブネット）内からのものしか受け付けない。同じローカルネットワーク３０からアクセスしてくる者は、ローカルネットワーク３０に参加を認められている（例えば無線ＡＰ４０のＳＳＩＤ及び暗号化キーを教えられている）という点で、拠点からある程度の信頼を受けている者と言える。この実施形態では、そのような者にのみ操作ＩＤを発行する。そのＵＲＬへのアクセスが、同じローカルネットワーク３０（サブネット）内からのものか否かは、例えばＡＲＰ（Address Resolution Protocol）等で機器管理システム１０からアクセス元の端末（例えば携帯端末６０）のＭＡＣ（Media Access Control）アドレスが取得できるか否かで判定すればよい。
</p>
<p num="0071">
  図１０に、この実施形態における機器管理システム１０の構成を示す。図１０の機器管理システム１０は、図２に示した第１実施形態の機器管理システム１０に対して、ＩＤ要求受付部１１１を追加したものである。
</p>
<p num="0072">
  ＩＤ要求受付部１１１は、ＩＤ発行受付用のウェブページを提供し、そのウェブページに対するユーザからのＩＤ要求を受け付ける。ここで、ＩＤ要求受付部１１１は、ＩＤ発行受付用のウェブページに対してアクセスしてきた端末（例えば携帯端末６０）が同じローカルネットワーク３０上のものであるか否かを確認し、同じローカルネットワーク３０上のものであれば、ＩＤ発行受付用のウェブページを応答する。携帯端末６０のウェブブラウザがこのＩＤ発行受付用のウェブページを表示し、ゲストがそのウェブページに表示されるＩＤ発行要求ボタンを押すと、ウェブブラウザから機器管理システム１０にＩＤ発行要求が送信される。ＩＤ要求受付部１１１は、そのＩＤ発行要求を受け付けて操作ＩＤ発行部１１４Ａに伝達する。なお、ＩＤ発行受付用のウェブページに対するアクセスが同じローカルネットワーク３０内からでない場合には、ＩＤ要求受付部１１１は、ＩＤ発行受付用のウェブページを応答せず、例えばその代わりにネットワーク外なので操作ＩＤを提供できない旨等を示すエラーページを応答する。
</p>
<p num="0073">
  操作ＩＤ発行部１１４Ａは、ＩＤ要求受付部１１１を介してゲストからのＩＤ発行要求を受けた場合に、あらかじめ定めた初期の利用権限（以下「初期利用権限」と呼ぶ）に対応付けた操作ＩＤを生成する。そして、その操作ＩＤを表示したウェブページを要求元のウェブブラウザに返す。初期利用権限は、ＩＤ要求受付部１１１に対する要求に対して付与するものとしてあらかじめ定められているものであり、例えば白黒のコピーのみを許可し、ネットワーク経由でのプリントやスキャン等の他の機能についての権限は一切許可しない、等の低レベルの権限である。初期利用権限の内容は、機器管理システム１０の管理者等がセキュリティポリシーに従って定め、機器管理システム１０に設定しておけばよい。
</p>
<p num="0074">
  また操作ＩＤ発行部１１４Ａは、ゲストから権限アップグレード要求を受けると、そのゲストが社内ゲストであれば、社内ゲスト用にあらかじめ定められている、より高い権限内容の利用権限に対応付けた操作ＩＤをゲストに提供する（あるいは元の操作ＩＤに対応する初期利用権限を、社内ゲスト用の権限内容にアップグレードする）。権限アップグレード要求の要求元のゲストが社内ゲストであるか否かは、そのゲストに、組織のディレクトリサービス５０に登録されているユーザ情報と認証情報（パスワード等）の入力を求めることで行う。すなわち、この求めに応じて入力されたユーザ情報と認証情報が確かに登録されているかを、問合せ部１１２によりディレクトリサービス５０に問い合わせ、登録されている旨の回答を得た場合には、そのゲストが社内ゲストであると判定する。ディレクトリサービス５０からの回答が「登録されていない」旨のものである場合には、そのゲストは社外ゲストであり、社外ゲストについては権限アップグレード要求では利用権限のアップグレードは認めない。
</p>
<p num="0075">
  また操作ＩＤ発行部１１４Ａは、上記第１実施形態と同様、承認権限のある正規ユーザから承認を受けた場合に、ゲストの利用権限を拡大する処理（例えば承認された機能についての権限を追加した操作ＩＤを新たにゲストに提供）を実行する。
</p>
<p num="0076">
  図１１を参照して、この実施形態における処理の流れの例を示す。
</p>
<p num="0077">
  まずユーザ（ゲスト）は、拠点に入ると、自分の携帯端末６０を拠点内の無線ＡＰ４０に接続する。そして、携帯端末６０のウェブブラウザで、訪問先の正規ユーザ等から知得したＩＤ発行受付用のウェブページにアクセスし、操作ＩＤの取得要求を行う（Ｓ１０１）。
</p>
<p num="0078">
  機器管理システム１０は、ＩＤ発行受付用のウェブページにアクセスしてきた携帯端末６０が、同じローカルネットワーク３０（同一サブネット）内のものか否かを判定する。そして、同じローカルネットワーク３０内のものであると判定した場合には、あらかじめ定めた初期利用権限に対応付けた操作ＩＤを生成し（Ｓ１０２）、その操作ＩＤを表示したウェブページを携帯端末６０宛に返す（Ｓ１０３）。また機器管理システム１０は、その操作ＩＤのエントリを操作ＩＤ情報（図４参照）に作成し、そのエントリに初期利用権限の情報を登録する。
</p>
<p num="0079">
  図１２に、この操作ＩＤ通知用のウェブページ４００の表示例を示す。このウェブページ４００には、操作ＩＤの値「1234」と、初期利用権限の内容の説明「白黒コピーのみ」が表示されている。
</p>
<p num="0080">
  ゲストは、機器２０の表示装置（タッチパネル）にメニュー画面３１０（図６参照）を表示させ、例えばその中でスキャン機能のアイコンを押したとする（Ｓ１０４）。機器２０は、選択されたスキャン機能を実行してよいか、機器管理システム１０に問い合わせる。機器管理システム１０は、その機器２０を操作しているゲストからは正規ユーザとしてのログインも操作ＩＤの入力もなされていないので、そのゲストには機器２０の利用権限がないと判定し、操作ＩＤ入力画面３２０を機器２０の表示装置に表示する（Ｓ１０５）。
</p>
<p num="0081">
  ここでゲストが、例えば先ほど入手して携帯端末６０の画面に表示されている操作ＩＤを入力したとする（Ｓ１０６）。機器２０からその操作ＩＤを受け取った機器管理システム１０は、その操作ＩＤに対応する利用権限の内容と、ゲストが先ほど利用したいと要求した機能（スキャン）とを照合する（Ｓ１０７）。この時点でゲストが入手している操作ＩＤは、Ｓ１０３で取得した初期操作権限（「白黒コピーのみ」）に対応付けられているので、Ｓ１０７では、スキャンの権限はないと判定される。この場合、機器管理システム１０は、機器２０に対して社員認証画面の表示を指示する（Ｓ１０８）。図示は省略するが、社員認証画面は、ユーザＩＤ入力欄とパスワード入力欄とを有しており、そのゲストが組織（例えばその拠点を有する会社）のメンバであれば、それら入力欄に対して、組織（ディレクトリサービス５０）に登録しているユーザＩＤ及びパスワードを入力する（Ｓ１０９）。
</p>
<p num="0082">
  機器管理システム１０は、ゲストが入力したユーザＩＤ及びパスワードを機器２０から取得すると、問合せ部１１２によりディレクトリサービス５０に対して、そのユーザＩＤ及びパスワードのペアに該当するユーザが登録されているかどうかを問い合わせる（Ｓ１１０）。登録されていれば、そのゲストは組織のメンバ（社員）であり、社内ゲストに分類される。この問合せに対するディレクトリサービス５０からの回答が、「登録されている」ことを示すものである場合、機器管理システム１０は、あらかじめ定められている社内ゲスト用の利用権限に対応付けた新たな操作ＩＤを生成し（Ｓ１１１）、その操作ＩＤを携帯端末６０のウェブブラウザに通知する（Ｓ１１２）。この通知は、例えば、機器管理システム１０が、Ｓ１０３でゲストの携帯端末６０に提供した操作ＩＤ通知用のウェブページの内容を、その新たな操作ＩＤを表示したものに更新することで行えばよい。例えば、操作ＩＤ通知用のウェブページが、定期的に当該ページのＵＲＬに更新の有無を問合せ、更新があれば更新後のウェブページを取得するよう構成されていれば、新たな操作ＩＤを表示したウェブページが携帯端末６０に表示されることになる。また別の例として操作ＩＤ通知用のウェブページに更新ボタンを設けておき、ゲストがその更新ボタンを押すと、更新要求が機器管理システム１０に送信され、機器管理システム１０から新たな操作ＩＤを表示したウェブページが応答されるようにしてもよい。図１２に、権限アップグレード後の新たな操作ＩＤを表示したウェブページ４１０を例示する。
</p>
<p num="0083">
  なお、Ｓ１１１で生成した新たな操作ＩＤは、機器２０の表示装置に表示してもよい。
</p>
<p num="0084">
  機器管理システム１０は、Ｓ１０９の後、再度操作ＩＤ入力画面３２０を表示する（Ｓ１１３）。ゲストが、その操作ＩＤ入力画面３２０にＳ１１２で入手した新たな操作ＩＤを入力し、操作継続ボタン３２４（図６参照）を押下すると、その操作ＩＤが機器２０から機器管理システム１０に伝達される（Ｓ１１４）。機器管理システム１０は、その操作ＩＤに対応する利用権限を調べ、これにより要求されているスキャン機能が許可されている（この例では社内ゲストの利用権限にはスキャン権限が含まれているものとする）ことが分かると、機器２０に対してスキャン機能の実行を許可する（Ｓ１１５）。
</p>
<p num="0085">
  以上、第２実施形態の主要な構成及び処理について説明した。この第２実施形態でも、第１実施形態と同様、機器２０が提供する機能の中には、ゲストが利用するに際して承認権を持つ正規ユーザの承認を必要とするものがあってもよい。ゲストがメニュー画面３１０（図６参照）でそのような承認を要する機能を選んだ場合の機器管理システム１０の処理は、第１実施形態のものと基本的に同じでよい。異なる点は、第１実施形態では承認後の権限に対応付けた操作ＩＤをゲストの電子メールアドレスに対して通知するのに対し、この第２実施形態ではＳ１０３と同様操作ＩＤ通知用のウェブページ（又は機器２０の表示装置への表示）の形で通知する点である。
</p>
<p num="0086">
  以上に説明したように、第２実施形態では、機器管理システム１０と同じローカルネットワーク３０に参加している端末を操作しているゲストには低レベルの初期利用権限を付与し、そのようなゲストのうち社内ゲストに該当するものには、要求に応じて、より高いレベルの利用権限を付与する。これにより、ゲストは、社外か社内かの種別に応じた権限で機器２０を利用することとなる。
</p>
<p num="0087">
  以上に説明した第１及び第２実施形態では、ゲストに対する機器２０の利用の承認は機能毎に行ったが、この代わりに、承認者が承認した場合にその承認者が持つ利用権限と同じものをゲストに付与するようにしてもよい。
</p>
<p num="0088">
  また第１及び第２実施形態では、ゲストの利用に対して正規ユーザによる承認が必要か否か機能毎にあらかじめ定められているとしたが、これは一例に過ぎない。この代わりに、特定の機能に限定せず、ゲストが利用を要求した機能がそのゲストが入力した操作ＩＤに対応する利用権限では利用が認められないものである場合、正規ユーザから承認を得ることでゲストがその機能を利用できるようにしてもよい。
</p>
<p num="0089">
  以上に例示した機器管理システム１０は、コンピュータにそのシステムの機能を表すプログラムを実行させることにより実現される。ここで、コンピュータは、例えば、ハードウエアとして、ＣＰＵ等のマイクロプロセッサ、ランダムアクセスメモリ（ＲＡＭ）およびリードオンリメモリ（ＲＯＭ）等のメモリ（一次記憶）、ＨＤＤ（ハードディスクドライブ）やＳＳＤ（ソリッドステートドライブ）等の固定記憶装置を制御するコントローラ、各種Ｉ／Ｏ（入出力）インタフェース、ローカルエリアネットワークなどのネットワークとの接続のための制御を行うネットワークインタフェース等が、たとえばバス等を介して接続された回路構成を有する。また、そのバスに対し、例えばＩ／Ｏインタフェース経由で、ＣＤやＤＶＤなどの可搬型ディスク記録媒体に対する読み取り及び／又は書き込みのためのディスクドライブ、フラッシュメモリなどの各種規格の可搬型の不揮発性記録媒体に対する読み取り及び／又は書き込みのためのメモリリーダライタ、などが接続されてもよい。上に例示した各機能モジュールの処理内容が記述されたプログラムがＣＤやＤＶＤ等の記録媒体を経由して、又はネットワーク等の通信手段経由で、固定記憶装置に保存され、コンピュータにインストールされる。固定記憶装置に記憶されたプログラムがＲＡＭに読み出されＣＰＵ等のマイクロプロセッサにより実行されることにより、上に例示した機能モジュール群が実現される。
</p>
</description-of-embodiments>
<reference-signs-list>
<p num="0090">
  １０  機器管理システム、２０  機器、３０  ローカルネットワーク、５０  ディレクトリサービス、６０  携帯端末、１０２  ユーザ情報ＤＢ、１０４  ログイン処理部、１０６  権限管理部、１０８  利用履歴記録部、１１０  一時利用管理部、１１１ ＩＤ要求受付部、１１２  問合せ部、１１４，１１４Ａ  操作ＩＤ発行部、１１６  操作ＩＤ管理部。<br/>
 
</p>
</reference-signs-list>
</description><claims>
<claim num="1">
<claim-text>
  コンピュータを、<br/>
  システムに登録された正規ユーザのための第１の利用許可手段であって、前記ユーザから前記システムに登録された認証情報が入力された場合に、前記システムに登録された前記正規ユーザの利用権限の範囲内で前記システムの利用を許可する第１の利用許可手段、<br/>
  前記システムに登録されていないゲストユーザのための第２の利用許可手段、<br/>
  として機能させるプログラムであって、<br/>
  前記第２の利用許可手段は、<br/>
  ゲストユーザから入力されたユーザ識別情報を取得する取得手段と、<br/>
  前記システムが設けられている組織のメンバの情報を保持するディレクトリサービスに対して、前記取得手段が取得した前記ユーザ識別情報が登録されているか否かを問い合わせる問合せ手段と、<br/>
  前記問合せ手段による問合せに対して登録されている旨の応答を受けた場合と登録されていない旨の応答を受けた場合とで異なる利用権限の範囲内で、前記ユーザ識別情報を入力した前記ゲストユーザに前記システムの利用を許可する許可手段と、<br/>
  を有することを特徴とするプログラム。
</claim-text>
</claim>
<claim num="2">
<claim-text>
  前記ユーザ識別情報は前記ゲストユーザの通信アドレスであり、<br/>
  前記許可手段は、前記問合せ手段による問合せに対して登録されている旨の応答を受けた場合と登録されていない旨の応答を受けた場合とで異なる利用権限に対応付けた一時識別情報を前記通信アドレス宛に送信し、前記ゲストユーザから前記一時識別情報が入力された場合、前記一時識別情報に対応付けた前記利用権限に従って前記ゲストユーザに前記システムの利用を許可する、<br/>
  ことを特徴とする請求項１に記載のプログラム。
</claim-text>
</claim>
<claim num="3">
<claim-text>
  前記第２の利用許可手段は、<br/>
  前記システムの利用要求を受けた場合に、その利用要求の送信元が前記情報処理装置と同じローカルネットワーク上の装置であれば、当該送信元の装置に対して第１の利用権限と対応付けた一時識別情報を提供する手段を更に有し、<br/>
  前記許可手段は、前記問合せ手段による問合せに対して登録されている旨の応答を受けた場合、前記第１の利用権限とは異なる第２の利用権限と対応付けた一時識別情報を前記ゲストユーザに提供し、前記ゲストユーザから前記一時識別情報が入力された場合、前記一時識別情報に対応付けた前記利用権限に従って前記ゲストユーザに前記システムの利用を許可する、<br/>
  ことを特徴とする請求項１に記載のプログラム。
</claim-text>
</claim>
<claim num="4">
<claim-text>
  前記第２の利用許可手段は、<br/>
  前記ゲストユーザから利用対象に選択された前記システムの機能が、承認権限を有する正規ユーザの承認を必要とする機能であるか否かを判定する手段と、<br/>
  利用対象に選択された前記機能が承認を必要とすると判定された場合に、承認権限を有する正規ユーザに対して承認を求め、承認が得られると、前記ゲストユーザの利用権限に対して、利用対象に選択された前記機能が利用できる権限を追加する手段と、<br/>
  を更に有する請求項１〜３のいずれか１項に記載のプログラム。
</claim-text>
</claim>
<claim num="5">
<claim-text>
  システムに登録された正規ユーザのための第１の利用許可手段であって、前記ユーザから前記システムに登録された認証情報が入力された場合に、前記システムに登録された前記正規ユーザの利用権限の範囲内で前記システムの利用を許可する第１の利用許可手段と、<br/>
  前記システムに登録されていないゲストユーザのための第２の利用許可手段と、<br/>
  を有し、<br/>
  前記第２の利用許可手段は、<br/>
  ゲストユーザから入力されたユーザ識別情報を取得する取得手段と、<br/>
  前記システムが設けられている組織のメンバの情報を保持するディレクトリサービスに対して、前記取得手段が取得した前記ユーザ識別情報が登録されているか否かを問い合わせる問合せ手段と、<br/>
  前記問合せ手段による問合せに対して登録されている旨の応答を受けた場合と登録されていない旨の応答を受けた場合とで異なる利用権限の範囲内で、前記ユーザ識別情報を入力した前記ゲストユーザに前記システムの利用を許可する許可手段と、<br/>
  を有する情報処理装置。
</claim-text>
</claim>
<claim num="6">
<claim-text>
  コンピュータを、<br/>
  ユーザから利用対象に選択された機能が、承認権限を有する承認者ユーザの承認を必要とする機能であるか否かを判定する手段、<br/>
  利用対象に選択された前記機能が承認を必要とすると判定された場合に、前記承認者ユーザに対して承認を求め、承認が得られると、前記ユーザの利用権限に対して、利用対象に選択された前記機能が利用できる権限を追加する手段、<br/>
  として機能させるためのプログラム。
</claim-text>
</claim>
<claim num="7">
<claim-text>
  ユーザから利用対象に選択された機能が、承認権限を有する承認者ユーザの承認を必要とする機能であるか否かを判定する手段と、<br/>
  利用対象に選択された前記機能が承認を必要とすると判定された場合に、前記承認者ユーザに対して承認を求め、承認が得られると、前記ユーザの利用権限に対して、利用対象に選択された前記機能が利用できる権限を追加する手段と、<br/>
  を有する情報処理装置。<br/>
 
</claim-text>
</claim>
</claims><abstract>
  <p num="">【課題】組織内の一システムに登録されていないユーザを単にゲストとして一律に利用権限を与える場合と比べて、ゲストと組織との関係を考慮したよりきめ細かい利用権限の付与ができるようにする。<br/>【解決手段】組織内の拠点に設けられた機器２０は拠点毎の機器管理システム１０で管理されている。拠点に属する人はその拠点の機器管理システム１０にユーザ登録されているが、組織のメンバであっても別拠点に属する人は、その機器管理システム１０に登録されていない。ディレクトリサービス５０には、その組織のメンバ全員のメールアドレス等の情報を保持している。ゲストは、機器２０にメールアドレスを入力してログインする。機器管理システム１０は、そのメールアドレスが組織のメンバのものかディレクトリサービス５０に問い合わせる。組織のメンバのものであれば組織内用の利用権限を、そうでない場合は組織外用の利用権限を、そのユーザに与える。<br/>【選択図】図１</p>
</abstract><drawings>
<figure num="1">
<img id="000003" he="109" wi="85" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="2">
<img id="000004" he="85" wi="74" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="3">
<img id="000005" he="106" wi="85" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="4">
<img id="000006" he="118" wi="85" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="5">
<img id="000007" he="78" wi="85" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="6">
<img id="000008" he="117" wi="85" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="7">
<img id="000009" he="116" wi="84" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="8">
<img id="000010" he="122" wi="83" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="9">
<img id="000011" he="117" wi="85" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="10">
<img id="000012" he="85" wi="84" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="11">
<img id="000013" he="104" wi="85" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="12">
<img id="000014" he="121" wi="84" file="2017167716.tif" img-format="tif" img-content="drawing"/>
</figure>
</drawings><jp:overflow><p num="">(51)Int.Cl.                             ＦＩ                                    テーマコード（参考）<br/>                                           Ｇ０６Ｆ   21/62                               <br/></p></jp:overflow></jp-official-gazette>
