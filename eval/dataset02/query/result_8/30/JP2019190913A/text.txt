<?xml version="1.0" encoding='utf-8'?>
<!-- <?xml-stylesheet type="text/xsl" href="../../../../../XSL/gat-a.xsl"?> -->
<!DOCTYPE jp-official-gazette PUBLIC "-//JPO//DTD PUBLISHED PATENT/UTILITY MODEL APPLICATION 1.0//EN" "../../../../../DTD/gat-a.dtd">
<jp-official-gazette kind-of-jp="A" kind-of-st16="A" lang="ja" dtd-version="1.0" country="JP" xmlns:jp="http://www.jpo.go.jp"><bibliographic-data lang="ja" country="JP">
    <publication-reference>
      <document-id>
        <country>JP</country>
        <doc-number>2019190913</doc-number>
        <kind>公開特許公報(A)</kind>
        <date>20191031</date>
      </document-id>
    </publication-reference>
    <application-reference>
      <document-id>
        <doc-number>2018081788</doc-number>
        <date>20180420</date>
      </document-id>
    </application-reference>
    <invention-title>制御装置及び制御方法</invention-title>
    <parties>
      <jp:applicants-agents-article>
        <jp:applicants-agents sequence="1">
          <applicant sequence="1">
            <addressbook lang="ja">
              <name>オムロン株式会社</name>
              <registered-number>000002945</registered-number>
              <address>
                <text>京都府京都市下京区塩小路通堀川東入南不動堂町８０１番地</text>
              </address>
            </addressbook>
          </applicant>
          <agent sequence="1" jp:kind="representative">
            <addressbook>
              <name>村上  尚</name>
              <registered-number>100155712</registered-number>
            </addressbook>
            <jp:attorney/>
          </agent>
          <agent sequence="2" jp:kind="representative">
            <addressbook>
              <name>特許業務法人  志賀国際特許事務所</name>
              <registered-number>110001634</registered-number>
            </addressbook>
          </agent>
        </jp:applicants-agents>
      </jp:applicants-agents-article>
      <inventors>
        <inventor sequence="1">
          <addressbook>
            <name>久米  一樹</name>
            <address>
              <text>京都府京都市下京区塩小路通堀川東入南不動堂町８０１番地  オムロン株式会社内</text>
            </address>
          </addressbook>
        </inventor>
      </inventors>
    </parties>
    <classification-ipc><edition/><main-clsf>G01R  13/20        20060101AFI20191004BHJP        </main-clsf><further-clsf>G01R  13/02        20060101ALI20191004BHJP        </further-clsf></classification-ipc>
    <classification-national><country>JP</country><main-clsf>G01R13/20 U</main-clsf><further-clsf>G01R13/02</further-clsf><further-clsf>G01R13/20 T</further-clsf></classification-national>
    <number-of-claims jp:adopted-law="claim">3</number-of-claims>
    <figure-to-publish>
      <fig-number>1</fig-number>
    </figure-to-publish>
    <jp:request-for-examination true-or-false="false"/>
    <jp:filing-form>ＯＬ</jp:filing-form>
    <jp:total-pages>15</jp:total-pages>
  </bibliographic-data><jp:image-of-bibliographic-data><img id="000001" he="140" wi="160" file="2019190913.tif" img-format="tif" img-content="drawing"/></jp:image-of-bibliographic-data><jp:image-of-chosen-drawing>
    <img id="000002" he="82" wi="69" file="2019190913.tif" img-format="tif" img-content="drawing"/>
  </jp:image-of-chosen-drawing><description>

<technical-field>
<p num="0001">
  本発明は、制御装置及び制御方法に関する。
</p>
</technical-field>
<background-art>
<p num="0002">
  センサやモータ等の機器から出力される信号を用いることによって種々の処理を行う装置が提案されている。例えば、特許文献１には、サンプリングによって得られた信号波形と参照波形とを比較した結果に基づき測定対象の物体の良否を判定する技術が開示されている。
</p>
</background-art>
<citation-list>
<patent-literature>
<p num="0003">
<patcit num="1"><text>特開２０１２−１９６２５０号公報</text></patcit>
</p>
</patent-literature>
</citation-list>
<summary-of-invention>
<tech-problem>
<p num="0004">
  このような処理を行う場合、センサやモータ等の機器から出力される時系列の信号の中から、実際の判定処理に用いられる時間区間の信号（以下「対象信号」という。）を取得する必要がある。しかしながら、取得される対象信号（例えば上記信号波形）と、比較対象となる信号（例えば上記参照波形）とに時間方向のずれが生じる場合がある。このような場合、実際には良と判定されるべき対象信号が、時間方向のずれにより否と判定されてしまうおそれがある。逆に、実際には否と判定されるべき対象信号が良と判定されてしまうおそれもある。また、このような判定結果は、時間方向のずれにより生じるだけでなく、測定対象の物体が正常に測定されていない場合に得られた信号値のずれにより生じる場合もある。このような問題は、対象信号を他の信号と比較する場合に限定された問題ではなく、時間又は信号値に応じて変化する条件（以下「比較条件」という。）と対象信号とを比較する場合全般に生じうる問題である。このように、対象信号と比較条件とのずれにより、比較処理の精度が変わってしまう場合があった。
</p>
<p num="0005">
  本発明は上記の点に鑑みてなされたものであり、対象信号と比較条件とにずれが生じていた場合であっても、より高い精度で比較を行うことができる制御装置及び制御方法を提供することを目的としている。
</p>
</tech-problem>
<tech-solution>
<p num="0006">
  本発明の一態様は、機器から出力される時系列の信号の時間変化を示す情報を記録する信号情報記録部と、予め定められた比較条件の時間変化を示す情報を記憶する比較条件記憶部と、前記信号情報記録部に記録された前記信号の時間変化と、前記比較条件記憶部に記憶されている前記比較条件の時間変化と、のいずれか一方又は双方を、時間軸方向のずれが小さくなるように時間軸方向に拡大又は縮小させる変更部と、前記変更部によって拡大又は縮小された後の時間変化を用いて前記信号と前記比較条件とを比較する比較部と、を備える制御装置である。
</p>
<p num="0007">
  本発明の一態様は、上記の制御装置であって、前記変更部は、前記比較条件において予め定められている複数の特徴部分に応じた各時刻と、前記信号の時間変化における複数の特徴部分に応じた各時刻と、が略一致するように拡大又は縮小を行う。
</p>
<p num="0008">
  本発明の一態様は、機器から出力される時系列の信号の時間変化を示す情報を記録する信号情報記録部と、予め定められた比較条件の時間変化を示す情報を記憶する比較条件記憶部と、を備える装置が、前記信号情報記録部に記録された前記信号の時間変化と、前記比較条件記憶部に記憶されている前記比較条件の時間変化と、のいずれか一方又は双方を、時間軸方向のずれが小さくなるように時間軸方向に拡大又は縮小させる変更ステップと、前記変更部によって拡大又は縮小された後の時間変化を用いて前記信号と前記比較条件とを比較する比較ステップと、を実行する制御方法である。
</p>
</tech-solution>
<advantageous-effects>
<p num="0009">
  本発明によれば、対象信号と比較条件とにずれが生じていた場合であっても、より高い精度で比較を行うことができる。
</p>
</advantageous-effects>
</summary-of-invention>
<description-of-drawings>
<p num="0010">
<figref num="1">制御システム１００の構成の具体例を示す図である。</figref>
<figref num="2">制御装置３の機能構成の実施形態の具体例を示すブロック図である。</figref>
<figref num="3">第１実施形態における制御装置３の動作例を示すフローチャートである。</figref>
<figref num="4">比較パターンの具体例を示す図である。</figref>
<figref num="5">対象信号の第１具体例を示す図である。</figref>
<figref num="6">比較パターンと、時間軸方向にシフトされていない対象信号とを同じ時間軸に並べて示した図である。</figref>
<figref num="7">比較パターンと、時間軸方向にシフトされた対象信号とを同じ時間軸に並べて示した図である。</figref>
<figref num="8">対象信号の第２具体例を示す図である。</figref>
<figref num="9">比較パターンと、信号値がシフトされていない対象信号とを同じ時間軸に並べて示した図である。</figref>
<figref num="10">比較パターンと、信号値がシフトされた対象信号とを同じ時間軸に並べて示した図である。</figref>
<figref num="11">対象信号の第３具体例を示す図である。</figref>
<figref num="12">比較パターンと、時間軸方向に拡大されていない対象信号とを同じ時間軸に並べて示した図である。</figref>
<figref num="13">比較パターンと、時間軸方向に拡大された対象信号とを同じ時間軸に並べて示した図である。</figref>
<figref num="14">制御システム１００の変形例の構成を示す図である。</figref>
</p>
</description-of-drawings>
<description-of-embodiments>
<p num="0011">
  図１は、制御システム１００の構成の具体例を示す図である。制御システム１００は、第１機器１１、第２機器１２、ＡＤ変換装置２、制御装置３及び端末装置４を備える。
</p>
<p num="0012">
  第１機器１１は、温度センサや圧力センサ等の入力機器、又は、サーボモーター等の出力機器である。第１機器１１は、入力機器である場合には、センシングを行った結果として得られる値を出力する。第１機器１１は、出力機器である場合には、動作の内容や動作後の状態等を示す値を出力する。第１機器１１は、ＡＤ変換装置２に対して接続される。第１機器１１は、アナログ値を示す電気信号をＡＤ変換装置２に対して出力する。
</p>
<p num="0013">
  第２機器１２は、温度センサや圧力センサ等の入力機器、又は、サーボモーター等の出力機器である。第２機器１２は、第１機器１１とは異なる装置として構成される。例えば、第１機器１１が測定対象の物体（以下「対象物体」という。）の表面形状を計測するために用いられる距離センサである場合には、第２機器１２は搬送される対象物体の位置を検知する検知装置であってもよい。例えば、第１機器１１が測定対象の空間（以下「対象空間」という。）の温度を計測するために用いられる温度センサである場合には、第２機器１２は対象空間の照度を測定する装置であってもよいし、対象空間に存在する人を検知する装置であってもよい。例えば、第１機器１１が搬送対象の物体（以下「搬送体」という。）を搬送するコンベアの駆動装置である場合には、第２機器１２は搬送体の位置を検知する検知装置であってもよい。このように、第２機器１２は、第１機器１１がセンシング又は作用する対象と同一の対象又は関連する対象に対してセンシング又は作用する機器である。
</p>
<p num="0014">
  ＡＤ変換装置２は、第１機器１１に接続され、第１機器１１から出力される時系列のアナログ信号を自装置に入力する。ＡＤ変換装置２は、アナログ信号をデジタル信号に変換し、変換したデジタル信号を制御装置３に出力する。
</p>
<p num="0015">
  制御装置３は、情報処理装置を用いて構成される。制御装置３は、例えばＰＬＣ（Programmable Logic Controller）である。制御装置３は、ＡＤ変換装置２に接続され、ＡＤ変換装置２から順次出力される時系列のデジタル信号を自装置に入力する。制御装置３は、所定の条件（記録開始条件）が満たされた場合に、ＡＤ変換装置２から出力されたデジタル信号の記録動作を開始する。制御装置３は、所定の条件（記録終了条件）が満たされた場合に、ＡＤ変換装置２から出力されたデジタル信号の記録動作を終了する。制御装置３は、記録動作を開始してから終了するまでに入力されたデジタル信号を示す情報を対象信号の情報として内部メモリに記録する。制御装置３は、内部メモリに記録された対象信号と、予め設定されている比較条件とを比較する。制御装置３は、比較結果に応じて対象信号について判定を行う。制御装置３は、判定結果を内部メモリに記録してもよいし、他の装置に出力してもよい。
</p>
<p num="0016">
  端末装置４は、ＰＣ（Personal Computer）やワークステーション、スマートフォン、携帯電話、タブレット端末などの情報処理装置である。端末装置４は、制御装置３と通信可能に構成される。端末装置４は、制御システム１００のユーザが制御装置３に対する各種操作を入力するために用いられる。
</p>
<p num="0017">
  次に、ＡＤ変換装置２及び制御装置３の構成について詳細に説明する。まず、図１を参照して、各装置のハードウェア構成を説明する。
</p>
<p num="0018">
  まず、ＡＤ変換装置２のハードウェア構成を説明する。ＡＤ変換装置２は、アナログ入力インタフェース２１、ＡＤ変換器２２、ＦＰＧＡ（Field Programmable Gate Array）２３、ＲＯＭ（Read Only Memory）２４、プロセッサ２５及び通信モジュール２６を備える。
</p>
<p num="0019">
  アナログ入力インタフェース２１は、アナログ信号の入力インタフェースである。アナログ入力インタフェース２１は、第１機器１１とＡＤ変換装置２とを接続し、第１機器１１から出力される時系列のアナログ信号をＡＤ変換装置２に入力する。
</p>
<p num="0020">
  ＡＤ変換器２２は、アナログ入力インタフェース２１を介して入力されたアナログ信号をデジタル信号に変換する。具体的には、ＡＤ変換器２２は、数マイクロ秒程度のサンプリング周期でアナログ信号をサンプリングし、サンプリングしたアナログ信号を所定の量子化レベルで量子化することによってデジタル信号に変換する。
</p>
<p num="0021">
  ＦＰＧＡ２３は、ＡＤ変換器２２によって変換されたデジタル信号に対して演算処理を施す回路である。演算処理の具体例として、デジタルフィルタ処理やオフセット／スパン設定処理等がある。デジタルフィルタ処理の具体例としては、ローパスフィルタや移動平均を用いた平滑化の処理がある。演算処理が施されたデジタル信号は通信モジュール２６を介して制御装置３に送信される。
</p>
<p num="0022">
  具体的には、ＡＤ変換装置２は、演算処理を行う回路としてＦＰＧＡ２３を構成するためのコンフィギュレーションデータを予めＲＯＭ２４に記憶している。ＦＰＧＡ２３は、ＡＤ変換装置２の起動時にＲＯＭ２４から読み出されたコンフィギュレーションデータをプロセッサ２５から取得し、取得したコンフィギュレーションデータに基づく論理回路の構成処理（一般にコンフィギュレーションと呼ばれる）を行うことにより、自身を演算処理を行う回路として構成する。
</p>
<p num="0023">
  通信モジュール２６は、ＡＤ変換装置２が制御装置３と通信するための通信インタフェースである。通信モジュール２６は、制御装置３の第１通信モジュール３１に接続され、ＦＰＧＡ２３によって演算処理が施されたデジタル信号を制御装置３に送信する。
</p>
<p num="0024">
  続いて、制御装置３のハードウェア構成を説明する。制御装置３は、内部バス３０によって接続された第１通信モジュール３１、第２通信モジュール３２、第３通信モジュール３３、補助記憶装置３４（比較条件記憶部の具体例）、バッファメモリ３５、ＲＡＭ（Random Access Memory）３６及びプロセッサ３７を備える。
</p>
<p num="0025">
  第１通信モジュール３１は、制御装置３がＡＤ変換装置２と通信するための通信インタフェースである。第１通信モジュール３１は、ＡＤ変換装置２の通信モジュール２６に接続され、ＡＤ変換装置２から送信されるデジタル信号を受信する。第１通信モジュール３１によって受信されたデジタル信号は、バッファメモリ３５に格納される。
</p>
<p num="0026">
  第２通信モジュール３２は、制御装置３が端末装置４と通信するための通信インタフェースである。第２通信モジュール３２は、端末装置４が備える通信インタフェースに接続され、端末装置４との間で各種情報の送受信を行う。
</p>
<p num="0027">
  第３通信モジュール３３は、制御装置３が第２機器１２と通信するための通信インタフェースである。第３通信モジュール３３は、第２機器１２が備える通信インタフェースに接続され、第２機器１２から送信される信号を受信する。第３通信モジュール３３が受信する信号は、第２機器１２又は不図示のＡＤ変換装置によってデジタル信号に変換された信号である。第３通信モジュール３３は、例えばEtherCAT（登録商標）等のネットワークのインタフェースであってもよい。
</p>
<p num="0028">
  補助記憶装置３４は、磁気ハードディスク装置や半導体記憶装置などの記憶装置を用いて構成される。補助記憶装置３４は、制御装置３の動作に必要な各種の設定情報や、制御装置３において取得又は生成される各種の情報を記憶する。
</p>
<p num="0029">
  バッファメモリ３５は、第１通信モジュール３１によってＡＤ変換装置２から受信されたデジタル信号の値を記憶する。バッファメモリ３５は、デジタル信号値の記憶と消去とを所定の動作周期ごとに繰り返し実行する。プロセッサ３７は、この動作周期に同期してバッファメモリ３５にアクセスすることで、バッファメモリ３５に記憶されているデジタル信号値を読み出しＲＡＭ３６（信号情報記録部の具体例）に記録することができる。
</p>
<p num="0030">
  ＲＡＭ３６及びプロセッサ３７は、制御装置３の動作を実現する各種処理を実行する。具体的には、プロセッサ３７は、補助記憶装置３４に記憶されたプログラムをＲＡＭ３６に読み込んで実行する。このプログラムの実行により、制御装置３は、図２に示す機能構成を有する装置として機能し、図２に示す各機能部の動作によってデジタル信号値の記録動作や比較動作等の処理を行う。
</p>
<p num="0031">
  図２は、制御装置３の機能構成の実施形態の具体例を示すブロック図である。実施形態における制御装置３は、プロセッサ３７がプログラムを実行することにより、記録部３７１、設定部３７２、決定部３７３、比較部３７５及び変更部３７６を備える装置として機能する。なお、制御装置３の各機能の全て又は一部は、ＡＳＩＣ（Application Specific Integrated Circuit）やＰＬＤ（Programmable Logic Device）やＦＰＧＡ等のハードウェアを用いて実現されてもよい。プログラムは、コンピュータ読み取り可能な記録媒体に記録されてもよい。コンピュータ読み取り可能な記録媒体とは、例えばフレキシブルディスク、光磁気ディスク、ＲＯＭ、ＣＤ−ＲＯＭ等の可搬媒体、コンピュータシステムに内蔵されるハードディスク等の記憶装置である。プログラムは、電気通信回線を介して送信されてもよい。
</p>
<p num="0032">
  変更部３７６は、対象信号の波形を時間軸方向にシフトするという変更処理を実行することによって、比較部３７５によって比較処理に用いられる信号波形を取得する。変更部３７６は、対象信号の波形の信号値をシフトするという変更処理を実行することによって、比較部３７５によって比較処理に用いられる信号波形を取得する。変更部３７６は、複数の時刻について、対象信号の波形の特徴部分の各時刻と、比較パターンにおいて特徴部分に相当する部分の各時刻とを一致させるように対象信号の波形を時間軸方向に拡大又は縮小するという変更処理を実行することによって、比較部３７５によって比較処理に用いられる信号波形を取得する。
</p>
<p num="0033">
  変更部３７６は、補助記憶装置３４に予め設定されている設定情報に含まれる変更条件に応じて、変更処理を実行する。変更条件は、対象信号の波形と、比較部３７５において対象信号と比較されるパターン（以下「比較パターン」という。）との時間軸方向のずれを補正するための条件である。変更条件は、例えば対象信号の波形の特徴部分の時刻と、比較パターンの特徴部分の時刻とを一致させるための条件である。特徴部分は、対象信号において１つ又は少数（例えば２つ又は３つ）しか生じ得ない特徴的な部分である。特徴部分の具体例として、変曲点、極大値、極小値、ゼロクロス点がある。特徴部分は、例えば信号開始タイミング又は信号終了タイミングを基準として所定の時間間隔の間に位置する変曲点、極大値、極小値又はゼロクロス点として定義されてもよい。特徴部分は、例えば信号開始タイミング以降においてｎ番目に表れた変曲点、極大値、極小値又はゼロクロス点として定義されてもよい。なお、ｎは１以上の整数である。
</p>
<p num="0034">
  変更３７６は、対象信号の波形の特徴部分の時刻と、比較パターンにおいて特徴部分に相当する部分の時刻と、を一致させるように対象信号の波形を時間軸方向にシフトする。
</p>
<p num="0035">
  変更３７６は、対象信号の波形の特徴部分の信号値（以下「対象信号特徴値」という。）を、比較パターンにおいて特徴部分に相当する第１部分の信号値（以下「第１比較特徴値」という。）から、比較パターンにおいて特徴部分に相当する第２部分の信号値（以下「第２比較特徴値」という。）までの範囲に含めるように、対象信号の波形の信号値をシフトする。特徴値の個数は複数でもよい。
</p>
<p num="0036">
  変更３７６は、対象信号の波形の複数の時刻について、対象信号の波形の特徴部分の各時刻と、比較パターンにおいて特徴部分に相当する部分の各時刻と、を一致させるように対象信号の波形を時間軸方向に拡大又は縮小する。対象信号の波形の第１時刻から第２時刻までの時間の拡大率又は縮小率と、対象信号の波形の第１時刻から第３時刻までの時間の拡大率又は縮小率とは、異なっていてもよい。対象信号の波形の第１時刻から第２時刻までの時間の拡大率又は縮小率と、対象信号の波形の第２時刻から第３時刻までの時間の拡大率又は縮小率とは、異なっていてもよい。
</p>
<p num="0037">
  変更３７６は、対象信号の波形を時間軸方向にシフトする変更処理と、対象信号の波形の信号値をシフトする変更処理と、対象信号の波形を時間軸方向に拡大又は縮小する変更処理とのうちの少なくとも二つを、互いに組み合わせてもよい。
</p>
<p num="0038">
  比較部３７５は、変更部３７６によって変更処理が実行された対象信号と、補助記憶装置３４に予め登録されている比較パターンと、を比較する。比較パターンは、対象信号の波形の各時刻における閾値を示す。比較パターンの具体例については後述する。
</p>
<p num="0039">
  図３は、実施形態における制御装置３の動作例を示すフローチャートである。図３に示すフローチャートは、制御装置３が比較処理を行う際の処理の流れを示す。
</p>
<p num="0040">
  まず、補助記憶装置３４に記憶されている記録開始条件及び記録終了条件に応じて記録部３７１が記録動作を実行する（ステップＳ２０１）。記録動作の実行によって対象信号がＲＡＭ３６に記録される。変更部３７６は、補助記憶装置３４に記憶されているシフト条件に応じて、対象信号における特徴部分を検出する（ステップＳ２０２）。変更ト部３７６は、検出された特徴部分に基づいて、対象信号をシフトする（ステップＳ２０３）。比較部３７５は、変更処理が実行された対象信号と、補助記憶装置３４に記憶されている比較条件に応じた比較パターンとを比較する（ステップＳ２０４）。比較部３７５は、比較結果に応じて判定処理を行う。比較部３７５は、判定結果を出力する（ステップＳ２０５）。
</p>
<p num="0041">
  図４は、比較パターンの具体例を示す図である。比較パターンは、対象信号の判定結果に係る閾値の領域を示す。例えば、図４に示される比較パターンは、対象信号の各時刻における上限値を示す波形である上限波形８１と、対象信号の各時刻における下限値を示す波形である下限波形８２と、を含む。
</p>
<p num="0042">
  比較パターンにおいて、少なくとも一つの特徴部分に応じた時刻が、特徴時刻として予め定義される。図４の例では、極大値に応じた時刻が、第１特徴時刻として予め定義される。各変曲点に応じた時刻が、各特徴時刻として予め定義される。
</p>
<p num="0043">
  比較パターンにおいて、少なくとも一つの特徴部分に応じた値が、特徴値として予め定義される。図４の例では、上限波形８１の極大値に応じた値が、第１上限波形特徴値として予め定義される。上限波形８１の各変曲点に応じた値が、第１上限波形特徴値以外の各上限波形特徴値として予め定義される。下限波形８２の極大値に応じた値が、第１下限波形特徴値として予め定義される。下限波形８２の各変曲点に応じた値が、第２下限波形特徴値以外の各下限波形特徴値として予め定義される。
</p>
<p num="0044">
  図５は、対象信号の具体例を示す図である。図５において、波形８３が対象信号の波形を示す。<br/>
  図６は、比較パターンと、変更部３７６によってシフトされていない対象信号とを同じ時間軸に並べて示した図である。図６に示される比較パターンは、図４に示されている比較パターンである。図６に示される対象信号は、図５に示されている対象信号である。図６に示されるように、対象信号において特徴部分が現れる時刻Ｔ１と、比較パターンにおいて特徴部分が現れる時刻Ｔ２と、には時間のずれが生じている。このずれにより、比較パターンと比較される対象信号の値が、理想的な値ではなくなっている。例えば、比較パターンにおける時刻Ｔ２と比較される対象信号の値（時刻Ｔ２における信号の値）は、下限波形８２よりも低い。そのため、図６の例では対象信号の値は、上限波形８１と下限波形８２との間に位置しておらず、条件を満たしていないと判定されてしまう。
</p>
<p num="0045">
  図７は、比較パターンと、変更部３７６によってシフトされた対象信号とを同じ時間軸に並べて示した図である。変更部３７６は、対象信号の波形において、予め定義された条件を満たす特徴部分を検出する。そして、変更部３７６は、検出された特徴部分に応じた時刻を特徴時刻として検出し、対象信号をシフトする。図７では、対象信号の特徴時刻と比較パターンの特徴時刻とが一致するように、対象信号が時間軸方向にシフトされている。
</p>
<p num="0046">
  変更部３７６は、所定の位置を搬送体が通過した時刻に応じて、対象信号の時間軸方向へのシフト量を変更してもよい。例えば、変更部３７６は、所定の位置を搬送体が通過した時刻が遅いほど、対象信号の時間軸方向へのシフト量を多くしてもよい。
</p>
<p num="0047">
  比較部３７５は、このようにシフトされた後の対象信号と比較パターンとを比較する。例えば、図７の例では、比較部３７５は、対象信号の信号値が各時刻において上限値及び下限値の間に位置しているか否か比較する。比較部３７５は、対象信号の信号値が各時刻において上限値及び下限値の間に位置している場合に、対象信号が正しい対象信号であると判定してもよい。例えば、対象信号が得られた物体が良品であると判定されてもよい。
</p>
<p num="0048">
  このように構成された実施形態における制御装置３では、対象信号と比較条件との特徴部分の出現時刻が一致するように、対象信号がシフトされる。そのため、対象信号と比較条件との時間軸方向のずれを小さくすることができる。そのため、より高い精度で比較を行うことが可能となる。特に対象信号や比較条件が時間軸方向で急峻に変化する場合には、時間軸方向のわずかなずれによって比較結果が大きく変わってしまうおそれがある。しかしながら、実施形態における制御装置３では、上述したように時間軸方向のずれを小さくすることができるため、たとえ対象信号や比較条件が時間軸方向で急峻に変化する場合であっても、より高い精度で比較を行うことが可能となる。
</p>
<p num="0049">
  図８は、対象信号の第２具体例を示す図である。図８において、波形８３が対象信号の波形を示す。図８における対象信号は、図５における対象信号と比較して、信号値が大きくなる方向にシフトしている。
</p>
<p num="0050">
  図９は、比較パターンと、変更部３７６によって信号値がシフトされていない対象信号とを同じ時間軸に並べて示した図である。図９に示される比較パターンは、図４に示されている比較パターンである。図９に示される対象信号は、図８に示されている対象信号である。図９に示されるように、対象信号において特徴部分が現れている第１特徴値は、比較パターンの上限波形８１において特徴部分が現れている第１上限波形特徴値から、比較パターンの下限波形８２において特徴部分が現れている第１下限波形特徴値までの範囲には含まれていない。このため、比較パターンと比較される対象信号の値が、理想的な値ではなくなっている。例えば、比較パターンの上限波形８１における第１上限波形特徴値と比較される対象信号の第１特徴値は、上限波形８１よりも大きい。そのため、図９の例では対象信号の第１特徴値は、上限波形８１の第１上限波形特徴値と下限波形８２の第１下限波形特徴値との間に位置しておらず、条件を満たしていないと判定されてしまう。
</p>
<p num="0051">
  図１０は、比較パターンと、変更部３７６によって信号値がシフトされた対象信号とを同じ時間軸に並べて示した図である。変更部３７６は、対象信号の波形において、予め定義された条件を満たす特徴部分を検出する。そして、変更部３７６は、検出された特徴部分に応じた信号値を特徴値として検出し、対象信号の信号値をシフトする。図１０では、対象信号の第１特徴値が、上限波形８１の第１上限波形特徴値と下限波形８２の第１下限波形特徴値との間に位置するように、対象信号の信号値がシフトされている。
</p>
<p num="0052">
  変更部３７６は、搬送体を成型するプレスの圧力に応じて、対象信号の値が変化する方向のシフト量を変更してもよい。例えば、変更部３７６は、搬送体を成型するプレスの圧力が大きいほど、対象信号の値が変化する方向のシフト量を多くしてもよい。
</p>
<p num="0053">
  比較部３７５は、このようにシフトされた後の対象信号と比較パターンとを比較する。例えば、図１０の例では、比較部３７５は、対象信号の信号値が各時刻において上限値及び下限値の間に位置しているか否か比較する。比較部３７５は、対象信号の信号値が各時刻において上限値及び下限値の間に位置している場合に、対象信号が正しい対象信号であると判定してもよい。例えば、対象信号が得られた物体が良品であると判定されてもよい。
</p>
<p num="0054">
  このように構成された実施形態における制御装置３では、対象信号の特徴部分が、上限波形８１の特徴部分と下限波形８２の特徴部分との間に位置するように、対象信号の信号値がシフトされる。そのため、対象信号と比較条件との信号値のずれを小さくすることができる。そのため、より高い精度で比較を行うことが可能となる。特に対象信号や比較条件が時間軸方向で急峻に変化する場合には、信号値のわずかなずれによって比較結果が大きく変わってしまうおそれがある。しかしながら、実施形態における制御装置３では、上述したように信号値のずれを小さくすることができるため、たとえ対象信号や比較条件の信号値にオフセットがある場合であっても、より高い精度で比較を行うことが可能となる。
</p>
<p num="0055">
  図１１は、対象信号の第３具体例を示す図である。図１１において、波形８３が対象信号の波形を示す。図１１における対象信号は、図５における対象信号と比較して、時間軸方向に縮小している。
</p>
<p num="0056">
  図１２は、比較パターンと、変更部３７６によって時間軸方向に拡大されていない対象信号とを同じ時間軸に並べて示した図である。図１２に示される比較パターンは、図４に示されている比較パターンである。図１２に示される対象信号は、図１１に示されている対象信号である。
</p>
<p num="0057">
  図１２に示されるように、対象信号において第１特徴部分が現れる第１特徴時刻と、比較パターンにおいて第１特徴部分が現れる第１特徴時刻とは一致している。図１２に示されるように、対象信号において第２特徴部分が現れる時刻Ｔ３と、比較パターンにおいて第２特徴部分が現れる時刻Ｔ４との間には、時間のずれが生じている。対象信号において第３特徴部分が現れる時刻Ｔ５と、比較パターンにおいて第３特徴部分が現れる時刻Ｔ７との間には、時刻Ｔ３から時刻Ｔ４までの時間よりも長い時間のずれが生じてもよい。対象信号において第４特徴部分が現れる時刻Ｔ６と、比較パターンにおいて第４特徴部分が現れる時刻Ｔ８との間には、時刻Ｔ５から時刻Ｔ７までの時間よりも長い時間のずれが生じてもよい。対象信号において第５特徴部分が現れる時刻Ｔ９と、比較パターンにおいて第５特徴部分が現れる時刻Ｔ１０との間には、時刻Ｔ６から時刻Ｔ８までの時間よりも長い時間のずれが生じてもよい。
</p>
<p num="0058">
  これらのずれにより、比較パターンと比較される対象信号の値が、理想的な値ではなくなっている。例えば、比較パターンにおける時刻Ｔ６と比較される対象信号の値（時刻Ｔ６における信号値）は、下限波形８２よりも低い。そのため、図１２の例では対象信号の値は、上限波形８１と下限波形８２との間に位置しておらず、条件を満たしていないと判定されてしまう。
</p>
<p num="0059">
  図１３は、比較パターンと、変更部３７６によって時間軸方向に拡大された対象信号とを同じ時間軸に並べて示した図である。変更部３７６は、対象信号の波形において、予め定義された条件を満たす複数の特徴部分を検出する。そして、変更部３７６は、検出された複数の特徴部分に応じた各時刻を各特徴時刻として検出し、特徴時刻ごとに対象信号を時間軸方向にシフトする。すなわち、変更部３７６は、検出された複数の特徴部分に応じた各時刻を各特徴時刻として検出し、対象信号を時間軸方向に拡大又は縮小する。
</p>
<p num="0060">
  変更部３７６は、例えば、第１の位置から第２の位置までの搬送体の搬送時間に応じて、対象信号を時間軸方向に拡大又は縮小する倍率を変更してもよい。例えば、変更部３７６は、第１の位置から第２の位置までの搬送体の搬送時間が長くなるほど、対象信号の時間変化が遅いため、対象信号の波形が時間軸方向にのびているので、対象信号を時間軸方向に縮小する倍率を大きくしてもよい。
</p>
<p num="0061">
  図１３では、対象信号の特徴時刻と比較パターンの各特徴時刻とが一致するように、対象信号が時間軸方向にシフトされている。比較部３７５は、このようにシフトされた後の対象信号と比較パターンとを比較する。例えば、図７の例では、比較部３７５は、対象信号の信号値が各時刻において上限値及び下限値の間に位置しているか否か比較する。比較部３７５は、対象信号の信号値が各時刻において上限値及び下限値の間に位置している場合に、対象信号が正しい対象信号であると判定してもよい。例えば、対象信号が得られた物体が良品であると判定されてもよい。
</p>
<p num="0062">
  このように構成された実施形態における制御装置３では、対象信号と比較条件との複数の特徴部分の各出現時刻が一致するように、対象信号が時間軸方向にシフトされる。そのため、対象信号と比較条件との時間軸方向のずれを小さくすることができる。そのため、より高い精度で比較を行うことが可能となる。特に対象信号や比較条件が時間軸方向に揺れ（ジッタ）を有する場合には、時間軸方向のわずかなずれによって比較結果が大きく変わってしまうおそれがある。しかしながら、実施形態における制御装置３では、上述したように時間軸方向のずれを小さくすることができるため、たとえ対象信号や比較条件が時間軸方向に揺れを有する場合であっても、より高い精度で比較を行うことが可能となる。制御装置３は、例えば、搬送体の搬送スピードの揺らぎを吸収することができるため判定のロバスト性が高いので、判定結果の精度を向上させることができる。
</p>
<p num="0063">
  図１４は、制御システム１００の変形例の構成を示す図である。図１４に示されるように、制御システム１００において、タイミング入力機器１３がＡＤ変換装置２に接続されてもよい。タイミング入力機器１３は、例えばタイミングセンサやメカスイッチである。タイミング入力機器１３は、所定の領域において対象物体の存在を検知する。タイミング入力機器１３は、検知結果を示すデジタル信号（オン信号又はオフ信号）をＡＤ変換装置２に対して出力する。ＡＤ変換装置２は、タイミング入力機器１３から出力されたデジタル信号を制御装置３に出力する。タイミング入力機器１３が出力するデジタル信号は、制御装置３において、対象物体に関するデジタル信号の記録動作開始のタイミングを判定するために使用されてもよい。すなわち、制御装置３の決定部３７３は、タイミング入力機器１３から出力されるデジタル信号に基づいて、記録動作を開始するタイミングや終了するタイミングを決定してもよい。
</p>
<p num="0064">
  （変形例）<br/>
  実施形態の制御装置３において、対象信号は記録部３７１によって記録されることによって取得される。しかし、制御装置３が対象信号を取得する方法は、記録部３７１による記録に限定される必要はない。例えば、制御装置３が第１通信モジュール３１、第２通信モジュール３２又は第３通信モジュール３３のいずれかを介して他の装置から対象信号のデータを受信してもよい。例えば、ＡＤ変換装置２が対象信号を記録する機能を有している場合、制御装置３は第１通信モジュール３１を介してＡＤ変換装置２から対象信号のデータを受信することによって対象信号を取得してもよい。
</p>
<p num="0065">
  実施形態において、対象信号に対して変更処理が実行されるのではなく、比較条件（例えば比較パターン）に対して変更処理が実行されてもよい。<br/>
  以上、この発明の実施形態について図面を参照して詳述してきたが、具体的な構成はこの実施形態に限られるものではなく、この発明の要旨を逸脱しない範囲の設計等も含まれる。
</p>
</description-of-embodiments>
<reference-signs-list>
<p num="0066">
１００…制御システム、  １１…第１機器、  １２…第２機器、  １３…タイミング入力機器、  ２…ＡＤ（Analog to Digital）変換装置、  ２０…内部バス、  ２１…アナログ入力インタフェース、  ２２…変換器、  ２３…ＦＰＧＡ（Field Programmable Gate Array）、  ２４…ＲＯＭ（Read Only Memory）、  ２５…プロセッサ、  ２６…通信モジュール、  ３…制御装置、  ３０…内部バス、  ３１…第１通信モジュール、  ３２…第２通信モジュール、  ３３…第３通信モジュール、  ３４…補助記憶装置、  ３５…バッファメモリ、  ３６…ＲＡＭ（Random Access Memory）、  ３７…プロセッサ、  ３７１…記録部、  ３７２…設定部、  ３７３…決定部、  ３７４…領域決定部、  ３７５…比較部、  ３７６…変更部、  ４…端末装置
</p>
</reference-signs-list>
</description><claims>
<claim num="1">
<claim-text>
  機器から出力される時系列の信号の時間変化を示す情報を記録する信号情報記録部と、<br/>
  予め定められた比較条件の時間変化を示す情報を記憶する比較条件記憶部と、<br/>
  前記信号情報記録部に記録された前記信号の時間変化と、前記比較条件記憶部に記憶されている前記比較条件の時間変化と、のいずれか一方又は双方を、時間軸方向のずれが小さくなるように時間軸方向に拡大又は縮小させる変更部と、<br/>
  前記変更部によって拡大又は縮小された後の時間変化を用いて前記信号と前記比較条件とを比較する比較部と、<br/>
を備える制御装置。
</claim-text>
</claim>
<claim num="2">
<claim-text>
  前記変更部は、前記比較条件において予め定められている複数の特徴部分に応じた各時刻と、前記信号の時間変化における複数の特徴部分に応じた各時刻と、が略一致するように拡大又は縮小を行う、請求項１に記載の制御装置。
</claim-text>
</claim>
<claim num="3">
<claim-text>
  機器から出力される時系列の信号の時間変化を示す情報を記録する信号情報記録部と、予め定められた比較条件の時間変化を示す情報を記憶する比較条件記憶部と、を備える装置が、<br/>
  前記信号情報記録部に記録された前記信号の時間変化と、前記比較条件記憶部に記憶されている前記比較条件の時間変化と、のいずれか一方又は双方を、時間軸方向のずれが小さくなるように時間軸方向に拡大又は縮小させる変更ステップと、<br/>
  前記変更ステップにおいて拡大又は縮小された後の時間変化を用いて前記信号と前記比較条件とを比較する比較ステップと、<br/>
を実行する制御方法。
</claim-text>
</claim>
</claims><abstract>
  <p num="">【課題】対象信号と比較条件とにずれが生じていた場合であっても、より高い精度で比較を行うこと。<br/>【解決手段】機器から出力される時系列の信号の時間変化を示す情報を記録する信号情報記録部と、予め定められた比較条件の時間変化を示す情報を記憶する比較条件記憶部と、信号情報記録部に記録された信号の時間変化と、比較条件記憶部に記憶されている比較条件の時間変化と、のいずれか一方又は双方を、時間軸方向のずれが小さくなるように時間軸方向に拡大又は縮小させる変更部と、変更部によって拡大又は縮小された後の時間変化を用いて信号と比較条件とを比較する比較部と、を備える制御装置である。<br/>【選択図】図１</p>
</abstract><drawings>
<figure num="1">
<img id="000003" he="100" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="2">
<img id="000004" he="111" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="3">
<img id="000005" he="62" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="4">
<img id="000006" he="115" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="5">
<img id="000007" he="103" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="6">
<img id="000008" he="103" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="7">
<img id="000009" he="103" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="8">
<img id="000010" he="103" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="9">
<img id="000011" he="111" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="10">
<img id="000012" he="111" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="11">
<img id="000013" he="107" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="12">
<img id="000014" he="107" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="13">
<img id="000015" he="107" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
<figure num="14">
<img id="000016" he="114" wi="85" file="2019190913.tif" img-format="tif" img-content="drawing"/>
</figure>
</drawings></jp-official-gazette>
